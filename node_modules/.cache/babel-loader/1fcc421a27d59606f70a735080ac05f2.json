{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.collectMethods = exports.DslMethodsCollectorVisitor = exports.getProductionDslName = exports.isBranchingProd = exports.isOptionalProd = exports.isSequenceProd = void 0;\n\nvar utils_1 = require(\"@chevrotain/utils\");\n\nvar gast_public_1 = require(\"./gast_public\");\n\nvar gast_visitor_public_1 = require(\"./gast_visitor_public\");\n\nfunction isSequenceProd(prod) {\n  return prod instanceof gast_public_1.Alternative || prod instanceof gast_public_1.Option || prod instanceof gast_public_1.Repetition || prod instanceof gast_public_1.RepetitionMandatory || prod instanceof gast_public_1.RepetitionMandatoryWithSeparator || prod instanceof gast_public_1.RepetitionWithSeparator || prod instanceof gast_public_1.Terminal || prod instanceof gast_public_1.Rule;\n}\n\nexports.isSequenceProd = isSequenceProd;\n\nfunction isOptionalProd(prod, alreadyVisited) {\n  if (alreadyVisited === void 0) {\n    alreadyVisited = [];\n  }\n\n  var isDirectlyOptional = prod instanceof gast_public_1.Option || prod instanceof gast_public_1.Repetition || prod instanceof gast_public_1.RepetitionWithSeparator;\n\n  if (isDirectlyOptional) {\n    return true;\n  } // note that this can cause infinite loop if one optional empty TOP production has a cyclic dependency with another\n  // empty optional top rule\n  // may be indirectly optional ((A?B?C?) | (D?E?F?))\n\n\n  if (prod instanceof gast_public_1.Alternation) {\n    // for OR its enough for just one of the alternatives to be optional\n    return utils_1.some(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else if (prod instanceof gast_public_1.NonTerminal && utils_1.contains(alreadyVisited, prod)) {\n    // avoiding stack overflow due to infinite recursion\n    return false;\n  } else if (prod instanceof gast_public_1.AbstractProduction) {\n    if (prod instanceof gast_public_1.NonTerminal) {\n      alreadyVisited.push(prod);\n    }\n\n    return utils_1.every(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else {\n    return false;\n  }\n}\n\nexports.isOptionalProd = isOptionalProd;\n\nfunction isBranchingProd(prod) {\n  return prod instanceof gast_public_1.Alternation;\n}\n\nexports.isBranchingProd = isBranchingProd;\n\nfunction getProductionDslName(prod) {\n  /* istanbul ignore else */\n  if (prod instanceof gast_public_1.NonTerminal) {\n    return \"SUBRULE\";\n  } else if (prod instanceof gast_public_1.Option) {\n    return \"OPTION\";\n  } else if (prod instanceof gast_public_1.Alternation) {\n    return \"OR\";\n  } else if (prod instanceof gast_public_1.RepetitionMandatory) {\n    return \"AT_LEAST_ONE\";\n  } else if (prod instanceof gast_public_1.RepetitionMandatoryWithSeparator) {\n    return \"AT_LEAST_ONE_SEP\";\n  } else if (prod instanceof gast_public_1.RepetitionWithSeparator) {\n    return \"MANY_SEP\";\n  } else if (prod instanceof gast_public_1.Repetition) {\n    return \"MANY\";\n  } else if (prod instanceof gast_public_1.Terminal) {\n    return \"CONSUME\";\n  } else {\n    throw Error(\"non exhaustive match\");\n  }\n}\n\nexports.getProductionDslName = getProductionDslName;\n\nvar DslMethodsCollectorVisitor =\n/** @class */\nfunction (_super) {\n  __extends(DslMethodsCollectorVisitor, _super);\n\n  function DslMethodsCollectorVisitor() {\n    var _this = _super !== null && _super.apply(this, arguments) || this; // A minus is never valid in an identifier name\n\n\n    _this.separator = \"-\";\n    _this.dslMethods = {\n      option: [],\n      alternation: [],\n      repetition: [],\n      repetitionWithSeparator: [],\n      repetitionMandatory: [],\n      repetitionMandatoryWithSeparator: []\n    };\n    return _this;\n  }\n\n  DslMethodsCollectorVisitor.prototype.reset = function () {\n    this.dslMethods = {\n      option: [],\n      alternation: [],\n      repetition: [],\n      repetitionWithSeparator: [],\n      repetitionMandatory: [],\n      repetitionMandatoryWithSeparator: []\n    };\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitTerminal = function (terminal) {\n    var key = terminal.terminalType.name + this.separator + \"Terminal\";\n\n    if (!utils_1.has(this.dslMethods, key)) {\n      this.dslMethods[key] = [];\n    }\n\n    this.dslMethods[key].push(terminal);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitNonTerminal = function (subrule) {\n    var key = subrule.nonTerminalName + this.separator + \"Terminal\";\n\n    if (!utils_1.has(this.dslMethods, key)) {\n      this.dslMethods[key] = [];\n    }\n\n    this.dslMethods[key].push(subrule);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitOption = function (option) {\n    this.dslMethods.option.push(option);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitRepetitionWithSeparator = function (manySep) {\n    this.dslMethods.repetitionWithSeparator.push(manySep);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitRepetitionMandatory = function (atLeastOne) {\n    this.dslMethods.repetitionMandatory.push(atLeastOne);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitRepetitionMandatoryWithSeparator = function (atLeastOneSep) {\n    this.dslMethods.repetitionMandatoryWithSeparator.push(atLeastOneSep);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitRepetition = function (many) {\n    this.dslMethods.repetition.push(many);\n  };\n\n  DslMethodsCollectorVisitor.prototype.visitAlternation = function (or) {\n    this.dslMethods.alternation.push(or);\n  };\n\n  return DslMethodsCollectorVisitor;\n}(gast_visitor_public_1.GAstVisitor);\n\nexports.DslMethodsCollectorVisitor = DslMethodsCollectorVisitor;\nvar collectorVisitor = new DslMethodsCollectorVisitor();\n\nfunction collectMethods(rule) {\n  collectorVisitor.reset();\n  rule.accept(collectorVisitor);\n  var dslMethods = collectorVisitor.dslMethods; // avoid uncleaned references\n\n  collectorVisitor.reset();\n  return dslMethods;\n}\n\nexports.collectMethods = collectMethods;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAaA;;AAGA,SAAgBA,cAAhB,CAA+BC,IAA/B,EAAgD;EAC9C,OACEA,IAAI,YAAYC,yBAAhB,IACAD,IAAI,YAAYC,oBADhB,IAEAD,IAAI,YAAYC,wBAFhB,IAGAD,IAAI,YAAYC,iCAHhB,IAIAD,IAAI,YAAYC,8CAJhB,IAKAD,IAAI,YAAYC,qCALhB,IAMAD,IAAI,YAAYC,sBANhB,IAOAD,IAAI,YAAYC,kBARlB;AAUD;;AAXDC;;AAaA,SAAgBC,cAAhB,CACEH,IADF,EAEEI,cAFF,EAEoC;EAAlC;IAAAA;EAAkC;;EAElC,IAAMC,kBAAkB,GACtBL,IAAI,YAAYC,oBAAhB,IACAD,IAAI,YAAYC,wBADhB,IAEAD,IAAI,YAAYC,qCAHlB;;EAIA,IAAII,kBAAJ,EAAwB;IACtB,OAAO,IAAP;EACD,CARiC,CAUlC;EACA;EACA;;;EACA,IAAIL,IAAI,YAAYC,yBAApB,EAAiC;IAC/B;IACA,OAAOK,aAAmBN,IAAK,CAACO,UAAzB,EAAqC,UAACC,OAAD,EAAqB;MAC/D,OAAOL,cAAc,CAACK,OAAD,EAAUJ,cAAV,CAArB;IACD,CAFM,CAAP;EAGD,CALD,MAKO,IAAIJ,IAAI,YAAYC,yBAAhB,IAA+BK,iBAASF,cAAT,EAAyBJ,IAAzB,CAAnC,EAAmE;IACxE;IACA,OAAO,KAAP;EACD,CAHM,MAGA,IAAIA,IAAI,YAAYC,gCAApB,EAAwC;IAC7C,IAAID,IAAI,YAAYC,yBAApB,EAAiC;MAC/BG,cAAc,CAACK,IAAf,CAAoBT,IAApB;IACD;;IACD,OAAOM,cACgBN,IAAK,CAACO,UADtB,EAEL,UAACC,OAAD,EAAqB;MACnB,OAAOL,cAAc,CAACK,OAAD,EAAUJ,cAAV,CAArB;IACD,CAJI,CAAP;EAMD,CAVM,MAUA;IACL,OAAO,KAAP;EACD;AACF;;AApCDF;;AAsCA,SAAgBQ,eAAhB,CAAgCV,IAAhC,EAAiD;EAC/C,OAAOA,IAAI,YAAYC,yBAAvB;AACD;;AAFDC;;AAIA,SAAgBS,oBAAhB,CAAqCX,IAArC,EAAoE;EAClE;EACA,IAAIA,IAAI,YAAYC,yBAApB,EAAiC;IAC/B,OAAO,SAAP;EACD,CAFD,MAEO,IAAID,IAAI,YAAYC,oBAApB,EAA4B;IACjC,OAAO,QAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,yBAApB,EAAiC;IACtC,OAAO,IAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,iCAApB,EAAyC;IAC9C,OAAO,cAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,8CAApB,EAAsD;IAC3D,OAAO,kBAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,qCAApB,EAA6C;IAClD,OAAO,UAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,wBAApB,EAAgC;IACrC,OAAO,MAAP;EACD,CAFM,MAEA,IAAID,IAAI,YAAYC,sBAApB,EAA8B;IACnC,OAAO,SAAP;EACD,CAFM,MAEA;IACL,MAAMW,KAAK,CAAC,sBAAD,CAAX;EACD;AACF;;AArBDV;;AAuBA;AAAA;AAAA;EAAgDW;;EAAhD;IAAA,sEACE;;;IACOC,kBAAY,GAAZ;IACAA,mBAAa;MAClBC,MAAM,EAAE,EADU;MAElBC,WAAW,EAAE,EAFK;MAGlBC,UAAU,EAAE,EAHM;MAIlBC,uBAAuB,EAAE,EAJP;MAKlBC,mBAAmB,EAAE,EALH;MAMlBC,gCAAgC,EAAE;IANhB,CAAb;;EA6DR;;EApDCC;IACE,KAAKC,UAAL,GAAkB;MAChBP,MAAM,EAAE,EADQ;MAEhBC,WAAW,EAAE,EAFG;MAGhBC,UAAU,EAAE,EAHI;MAIhBC,uBAAuB,EAAE,EAJT;MAKhBC,mBAAmB,EAAE,EALL;MAMhBC,gCAAgC,EAAE;IANlB,CAAlB;EAQD,CATD;;EAWOC,qDAAP,UAAqBE,QAArB,EAAuC;IACrC,IAAMC,GAAG,GAAGD,QAAQ,CAACE,YAAT,CAAsBC,IAAtB,GAA6B,KAAKC,SAAlC,GAA8C,UAA1D;;IACA,IAAI,CAACrB,YAAI,KAAKgB,UAAT,EAAqBE,GAArB,CAAL,EAAgC;MAC9B,KAAKF,UAAL,CAAgBE,GAAhB,IAAuB,EAAvB;IACD;;IACD,KAAKF,UAAL,CAAgBE,GAAhB,EAAqBf,IAArB,CAA0Bc,QAA1B;EACD,CANM;;EAQAF,wDAAP,UAAwBO,OAAxB,EAA4C;IAC1C,IAAMJ,GAAG,GAAGI,OAAO,CAACC,eAAR,GAA0B,KAAKF,SAA/B,GAA2C,UAAvD;;IACA,IAAI,CAACrB,YAAI,KAAKgB,UAAT,EAAqBE,GAArB,CAAL,EAAgC;MAC9B,KAAKF,UAAL,CAAgBE,GAAhB,IAAuB,EAAvB;IACD;;IACD,KAAKF,UAAL,CAAgBE,GAAhB,EAAqBf,IAArB,CAA0BmB,OAA1B;EACD,CANM;;EAQAP,mDAAP,UAAmBN,MAAnB,EAAiC;IAC/B,KAAKO,UAAL,CAAgBP,MAAhB,CAAuBN,IAAvB,CAA4BM,MAA5B;EACD,CAFM;;EAIAM,oEAAP,UAAoCS,OAApC,EAAoE;IAClE,KAAKR,UAAL,CAAgBJ,uBAAhB,CAAwCT,IAAxC,CAA6CqB,OAA7C;EACD,CAFM;;EAIAT,gEAAP,UAAgCU,UAAhC,EAA+D;IAC7D,KAAKT,UAAL,CAAgBH,mBAAhB,CAAoCV,IAApC,CAAyCsB,UAAzC;EACD,CAFM;;EAIAV,6EAAP,UACEW,aADF,EACiD;IAE/C,KAAKV,UAAL,CAAgBF,gCAAhB,CAAiDX,IAAjD,CAAsDuB,aAAtD;EACD,CAJM;;EAMAX,uDAAP,UAAuBY,IAAvB,EAAuC;IACrC,KAAKX,UAAL,CAAgBL,UAAhB,CAA2BR,IAA3B,CAAgCwB,IAAhC;EACD,CAFM;;EAIAZ,wDAAP,UAAwBa,EAAxB,EAAuC;IACrC,KAAKZ,UAAL,CAAgBN,WAAhB,CAA4BP,IAA5B,CAAiCyB,EAAjC;EACD,CAFM;;EAGT;AAAC,CAhED,CAAgDC,iCAAhD;;AAAajC;AAkEb,IAAMkC,gBAAgB,GAAG,IAAIf,0BAAJ,EAAzB;;AACA,SAAgBgB,cAAhB,CACEC,IADF,EACY;EASVF,gBAAgB,CAACG,KAAjB;EACAD,IAAI,CAACE,MAAL,CAAYJ,gBAAZ;EACA,IAAMd,UAAU,GAAGc,gBAAgB,CAACd,UAApC,CAXU,CAYV;;EACAc,gBAAgB,CAACG,KAAjB;EACA,OAAYjB,UAAZ;AACD;;AAhBDpB","names":["isSequenceProd","prod","gast_public_1","exports","isOptionalProd","alreadyVisited","isDirectlyOptional","utils_1","definition","subProd","push","isBranchingProd","getProductionDslName","Error","__extends","_this","option","alternation","repetition","repetitionWithSeparator","repetitionMandatory","repetitionMandatoryWithSeparator","DslMethodsCollectorVisitor","dslMethods","terminal","key","terminalType","name","separator","subrule","nonTerminalName","manySep","atLeastOne","atLeastOneSep","many","or","gast_visitor_public_1","collectorVisitor","collectMethods","rule","reset","accept"],"sourceRoot":"","sources":["../../../../../src/parse/grammar/gast/gast.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}