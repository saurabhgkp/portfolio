{"ast":null,"code":"import _objectSpread from\"/home/cliffexpc63/my example/portfolio/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/cliffexpc63/my example/portfolio/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef}from\"react\";import{useSphere}from\"@react-three/cannon\";import{useThree,useFrame}from\"@react-three/fiber\";import{FPVControls}from\"./FPVControls\";import{useKeyboardControls}from\"../hooks/useKeybord\";import{Vector3}from\"three\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SPEED=6;var JUMP=4;export var Player=function Player(props){var _useThree=useThree(),camera=_useThree.camera;var _useKeyboardControls=useKeyboardControls(),moveForward=_useKeyboardControls.moveForward,moveBackward=_useKeyboardControls.moveBackward,moveLeft=_useKeyboardControls.moveLeft,moveRight=_useKeyboardControls.moveRight,jump=_useKeyboardControls.jump;var _useSphere=useSphere(function(){return _objectSpread({mass:1,type:\"Dynamic\"},props);}),_useSphere2=_slicedToArray(_useSphere,2),ref=_useSphere2[0],api=_useSphere2[1];var velocity=useRef([0,0,0]);useEffect(function(){api.velocity.subscribe(function(v){return velocity.current=v;});},[api.velocity]);var pos=useRef([0,0,0]);useEffect(function(){return api.position.subscribe(function(v){return pos.current=v;});},[api.position]);useFrame(function(){// api.velocity.set(direction.x, velocity.current[1], direction.z)\n// ref.current.getWorldPosition(ref.current.position)\ncamera.position.copy(new Vector3(pos.current[0],pos.current[1],pos.current[2]));var direction=new Vector3();var frontVector=new Vector3(0,0,(moveBackward?1:0)-(moveForward?1:0));var sideVector=new Vector3((moveLeft?1:0)-(moveRight?1:0),0,0);direction.subVectors(frontVector,sideVector).normalize().multiplyScalar(SPEED).applyEuler(camera.rotation);api.velocity.set(direction.x,velocity.current[1],direction.z);if(jump&&Math.abs(velocity.current[1].toFixed(2))<0.05){api.velocity.set(velocity.current[0],JUMP,velocity.current[2]);}});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FPVControls,{}),/*#__PURE__*/_jsx(\"mesh\",{ref:ref})]});};","map":{"version":3,"names":["React","useEffect","useRef","useSphere","useThree","useFrame","FPVControls","useKeyboardControls","Vector3","SPEED","JUMP","Player","props","camera","moveForward","moveBackward","moveLeft","moveRight","jump","mass","type","ref","api","velocity","subscribe","v","current","pos","position","copy","direction","frontVector","sideVector","subVectors","normalize","multiplyScalar","applyEuler","rotation","set","x","z","Math","abs","toFixed"],"sources":["/home/cliffexpc63/my example/portfolio/src/Box/Player.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport { useSphere } from \"@react-three/cannon\";\nimport { useThree, useFrame } from \"@react-three/fiber\";\nimport { FPVControls } from \"./FPVControls\";\nimport { useKeyboardControls } from \"../hooks/useKeybord\";\nimport { Vector3 } from \"three\";\n\nconst SPEED = 6;\nconst JUMP = 4;\n\nexport const Player = (props) => {\n  const { camera } = useThree();\n  const { moveForward, moveBackward, moveLeft, moveRight, jump } =\n    useKeyboardControls();\n  const [ref, api] = useSphere(() => ({\n    mass: 1,\n    type: \"Dynamic\",\n    ...props,\n  }));\n\n  const velocity = useRef([0, 0, 0]);\n  useEffect(() => {\n    api.velocity.subscribe((v) => (velocity.current = v));\n  }, [api.velocity]);\n\n  const pos = useRef([0, 0, 0]);\n  useEffect(\n    () => api.position.subscribe((v) => (pos.current = v)),\n    [api.position]\n  );\n\n  useFrame(() => {\n    // api.velocity.set(direction.x, velocity.current[1], direction.z)\n    // ref.current.getWorldPosition(ref.current.position)\n\n    camera.position.copy(\n      new Vector3(pos.current[0], pos.current[1], pos.current[2])\n    );\n    const direction = new Vector3();\n\n    const frontVector = new Vector3(\n      0,\n      0,\n      (moveBackward ? 1 : 0) - (moveForward ? 1 : 0)\n    );\n    const sideVector = new Vector3(\n      (moveLeft ? 1 : 0) - (moveRight ? 1 : 0),\n      0,\n      0\n    );\n\n    direction\n      .subVectors(frontVector, sideVector)\n      .normalize()\n      .multiplyScalar(SPEED)\n      .applyEuler(camera.rotation);\n\n    api.velocity.set(direction.x, velocity.current[1], direction.z);\n\n    if (jump && Math.abs(velocity.current[1].toFixed(2)) < 0.05) {\n      api.velocity.set(velocity.current[0], JUMP, velocity.current[2]);\n    }\n  });\n  return (\n    <>\n      <FPVControls />\n      <mesh ref={ref} />\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}