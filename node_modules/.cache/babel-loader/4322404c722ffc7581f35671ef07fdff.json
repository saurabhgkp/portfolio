{"ast":null,"code":"import _objectSpread from \"/home/cliffexpc63/my example/portfolio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/home/cliffexpc63/my example/portfolio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/home/cliffexpc63/my example/portfolio/src/Box/Player.js\";\nimport React, { useEffect, useRef } from \"react\";\nimport { useSphere } from \"@react-three/cannon\";\nimport { useThree, useFrame } from \"@react-three/fiber\";\nimport { FPVControls } from \"./FPVControls\";\nimport { useKeyboardControls } from \"../hooks/useKeybord\";\nimport { Vector3 } from \"three\";\nvar SPEED = 5;\nvar JUMP = 5;\nexport var Player = function Player(props) {\n  var _useThree = useThree(),\n    camera = _useThree.camera;\n  var _useKeyboardControls = useKeyboardControls(),\n    moveForward = _useKeyboardControls.moveForward,\n    moveBackward = _useKeyboardControls.moveBackward,\n    moveLeft = _useKeyboardControls.moveLeft,\n    moveRight = _useKeyboardControls.moveRight,\n    jump = _useKeyboardControls.jump;\n  var _useSphere = useSphere(function () {\n      return _objectSpread({\n        mass: 1,\n        type: \"Dynamic\"\n      }, props);\n    }),\n    _useSphere2 = _slicedToArray(_useSphere, 2),\n    ref = _useSphere2[0],\n    api = _useSphere2[1];\n  var velocity = useRef([0, 0, 0]);\n  useEffect(function () {\n    api.velocity.subscribe(function (v) {\n      return velocity.current = v;\n    });\n  }, [api.velocity]);\n  var pos = useRef([0, 0, 0]);\n  useEffect(function () {\n    return api.position.subscribe(function (v) {\n      return pos.current = v;\n    });\n  }, [api.position]);\n  useFrame(function () {\n    // api.velocity.set(direction.x, velocity.current[1], direction.z)\n    // ref.current.getWorldPosition(ref.current.position)\n\n    camera.position.copy(new Vector3(pos.current[0], pos.current[1], pos.current[2]));\n    var direction = new Vector3();\n    var frontVector = new Vector3(0, 0, (moveBackward ? 1 : 0) - (moveForward ? 1 : 0));\n    var sideVector = new Vector3((moveLeft ? 1 : 0) - (moveRight ? 1 : 0), 0, 0);\n    direction.subVectors(frontVector, sideVector).normalize().multiplyScalar(SPEED).applyEuler(camera.rotation);\n    api.velocity.set(direction.x, velocity.current[1], direction.z);\n    if (jump && Math.abs(velocity.current[1].toFixed(2)) < 0.05) {\n      api.velocity.set(velocity.current[0], JUMP, velocity.current[2]);\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FPVControls, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    ref: ref,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }));\n};","map":{"version":3,"names":["React","useEffect","useRef","useSphere","useThree","useFrame","FPVControls","useKeyboardControls","Vector3","SPEED","JUMP","Player","props","camera","moveForward","moveBackward","moveLeft","moveRight","jump","mass","type","ref","api","velocity","subscribe","v","current","pos","position","copy","direction","frontVector","sideVector","subVectors","normalize","multiplyScalar","applyEuler","rotation","set","x","z","Math","abs","toFixed"],"sources":["/home/cliffexpc63/my example/portfolio/src/Box/Player.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport { useSphere } from \"@react-three/cannon\";\nimport { useThree, useFrame } from \"@react-three/fiber\";\nimport { FPVControls } from \"./FPVControls\";\nimport { useKeyboardControls } from \"../hooks/useKeybord\";\nimport { Vector3 } from \"three\";\n\nconst SPEED = 5;\nconst JUMP = 5;\n\nexport const Player = (props) => {\n  const { camera } = useThree();\n  const { moveForward, moveBackward, moveLeft, moveRight, jump } =\n    useKeyboardControls();\n  const [ref, api] = useSphere(() => ({\n    mass: 1,\n    type: \"Dynamic\",\n    ...props,\n  }));\n\n  const velocity = useRef([0, 0, 0]);\n  useEffect(() => {\n    api.velocity.subscribe((v) => (velocity.current = v));\n  }, [api.velocity]);\n\n  const pos = useRef([0, 0, 0]);\n  useEffect(\n    () => api.position.subscribe((v) => (pos.current = v)),\n    [api.position]\n  );\n\n  useFrame(() => {\n    // api.velocity.set(direction.x, velocity.current[1], direction.z)\n    // ref.current.getWorldPosition(ref.current.position)\n\n    camera.position.copy(\n      new Vector3(pos.current[0], pos.current[1], pos.current[2])\n    );\n    const direction = new Vector3();\n\n    const frontVector = new Vector3(\n      0,\n      0,\n      (moveBackward ? 1 : 0) - (moveForward ? 1 : 0)\n    );\n    const sideVector = new Vector3(\n      (moveLeft ? 1 : 0) - (moveRight ? 1 : 0),\n      0,\n      0\n    );\n\n    direction\n      .subVectors(frontVector, sideVector)\n      .normalize()\n      .multiplyScalar(SPEED)\n      .applyEuler(camera.rotation);\n\n    api.velocity.set(direction.x, velocity.current[1], direction.z);\n\n    if (jump && Math.abs(velocity.current[1].toFixed(2)) < 0.05) {\n      api.velocity.set(velocity.current[0], JUMP, velocity.current[2]);\n    }\n  });\n  return (\n    <>\n      <FPVControls />\n      <mesh ref={ref} />\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}