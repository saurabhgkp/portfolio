{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parse = exports.base_parse = void 0;\n\nvar css_select_1 = require(\"css-select\");\n\nvar he_1 = __importDefault(require(\"he\"));\n\nvar back_1 = __importDefault(require(\"../back\"));\n\nvar matcher_1 = __importDefault(require(\"../matcher\"));\n\nvar void_tag_1 = __importDefault(require(\"../void-tag\"));\n\nvar comment_1 = __importDefault(require(\"./comment\"));\n\nvar node_1 = __importDefault(require(\"./node\"));\n\nvar text_1 = __importDefault(require(\"./text\"));\n\nvar type_1 = __importDefault(require(\"./type\"));\n\nfunction decode(val) {\n  // clone string\n  return JSON.parse(JSON.stringify(he_1.default.decode(val)));\n} // https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements\n\n\nvar Htags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hgroup'];\nvar Dtags = ['details', 'dialog', 'dd', 'div', 'dt'];\nvar Ftags = ['fieldset', 'figcaption', 'figure', 'footer', 'form'];\nvar tableTags = ['table', 'td', 'tr'];\nvar htmlTags = ['address', 'article', 'aside', 'blockquote', 'br', 'hr', 'li', 'main', 'nav', 'ol', 'p', 'pre', 'section', 'ul'];\nvar kBlockElements = new Set();\n\nfunction addToKBlockElement() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var addToSet = function (array) {\n    for (var index = 0; index < array.length; index++) {\n      var element = array[index];\n      kBlockElements.add(element);\n      kBlockElements.add(element.toUpperCase());\n    }\n  };\n\n  for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n    var arg = args_1[_a];\n    addToSet(arg);\n  }\n}\n\naddToKBlockElement(Htags, Dtags, Ftags, tableTags, htmlTags);\n\nvar DOMTokenList =\n/** @class */\nfunction () {\n  function DOMTokenList(valuesInit, afterUpdate) {\n    if (valuesInit === void 0) {\n      valuesInit = [];\n    }\n\n    if (afterUpdate === void 0) {\n      afterUpdate = function () {\n        return null;\n      };\n    }\n\n    this._set = new Set(valuesInit);\n    this._afterUpdate = afterUpdate;\n  }\n\n  DOMTokenList.prototype._validate = function (c) {\n    if (/\\s/.test(c)) {\n      throw new Error(\"DOMException in DOMTokenList.add: The token '\".concat(c, \"' contains HTML space characters, which are not valid in tokens.\"));\n    }\n  };\n\n  DOMTokenList.prototype.add = function (c) {\n    this._validate(c);\n\n    this._set.add(c);\n\n    this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n\n  };\n\n  DOMTokenList.prototype.replace = function (c1, c2) {\n    this._validate(c2);\n\n    this._set.delete(c1);\n\n    this._set.add(c2);\n\n    this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n\n  };\n\n  DOMTokenList.prototype.remove = function (c) {\n    this._set.delete(c) && this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n  };\n\n  DOMTokenList.prototype.toggle = function (c) {\n    this._validate(c);\n\n    if (this._set.has(c)) this._set.delete(c);else this._set.add(c);\n\n    this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n\n  };\n\n  DOMTokenList.prototype.contains = function (c) {\n    return this._set.has(c);\n  };\n\n  Object.defineProperty(DOMTokenList.prototype, \"length\", {\n    get: function () {\n      return this._set.size;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DOMTokenList.prototype.values = function () {\n    return this._set.values();\n  };\n\n  Object.defineProperty(DOMTokenList.prototype, \"value\", {\n    get: function () {\n      return Array.from(this._set.values());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DOMTokenList.prototype.toString = function () {\n    return Array.from(this._set.values()).join(' ');\n  };\n\n  return DOMTokenList;\n}();\n/**\n * HTMLElement, which contains a set of children.\n *\n * Note: this is a minimalist implementation, no complete tree\n *   structure provided (no parentNode, nextSibling,\n *   previousSibling etc).\n * @class HTMLElement\n * @extends {Node}\n */\n\n\nvar HTMLElement =\n/** @class */\nfunction (_super) {\n  __extends(HTMLElement, _super);\n  /**\n   * Creates an instance of HTMLElement.\n   * @param keyAttrs\tid and class attribute\n   * @param [rawAttrs]\tattributes in string\n   *\n   * @memberof HTMLElement\n   */\n\n\n  function HTMLElement(tagName, keyAttrs, rawAttrs, parentNode, range, voidTag, _parseOptions) {\n    if (rawAttrs === void 0) {\n      rawAttrs = '';\n    }\n\n    if (voidTag === void 0) {\n      voidTag = new void_tag_1.default();\n    }\n\n    if (_parseOptions === void 0) {\n      _parseOptions = {};\n    }\n\n    var _this = _super.call(this, parentNode, range) || this;\n\n    _this.rawAttrs = rawAttrs;\n    _this.voidTag = voidTag;\n    /**\n     * Node Type declaration.\n     */\n\n    _this.nodeType = type_1.default.ELEMENT_NODE;\n    _this.rawTagName = tagName;\n    _this.rawAttrs = rawAttrs || '';\n    _this.id = keyAttrs.id || '';\n    _this.childNodes = [];\n    _this._parseOptions = _parseOptions;\n    _this.classList = new DOMTokenList(keyAttrs.class ? keyAttrs.class.split(/\\s+/) : [], function (classList) {\n      return _this.setAttribute('class', classList.toString());\n    } // eslint-disable-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call\n    );\n\n    if (keyAttrs.id) {\n      if (!rawAttrs) {\n        _this.rawAttrs = \"id=\\\"\".concat(keyAttrs.id, \"\\\"\");\n      }\n    }\n\n    if (keyAttrs.class) {\n      if (!rawAttrs) {\n        var cls = \"class=\\\"\".concat(_this.classList.toString(), \"\\\"\");\n\n        if (_this.rawAttrs) {\n          _this.rawAttrs += \" \".concat(cls);\n        } else {\n          _this.rawAttrs = cls;\n        }\n      }\n    }\n\n    return _this;\n  }\n  /**\n   * Quote attribute values\n   * @param attr attribute value\n   * @returns {string} quoted value\n   */\n\n\n  HTMLElement.prototype.quoteAttribute = function (attr) {\n    if (attr == null) {\n      return 'null';\n    }\n\n    return JSON.stringify(attr.replace(/\"/g, '&quot;'));\n  };\n  /**\n   * Remove Child element from childNodes array\n   * @param {HTMLElement} node     node to remove\n   */\n\n\n  HTMLElement.prototype.removeChild = function (node) {\n    this.childNodes = this.childNodes.filter(function (child) {\n      return child !== node;\n    });\n    return this;\n  };\n  /**\n   * Exchanges given child with new child\n   * @param {HTMLElement} oldNode     node to exchange\n   * @param {HTMLElement} newNode     new node\n   */\n\n\n  HTMLElement.prototype.exchangeChild = function (oldNode, newNode) {\n    var children = this.childNodes;\n    this.childNodes = children.map(function (child) {\n      if (child === oldNode) {\n        return newNode;\n      }\n\n      return child;\n    });\n    return this;\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"tagName\", {\n    get: function () {\n      return this.rawTagName ? this.rawTagName.toUpperCase() : this.rawTagName;\n    },\n    set: function (newname) {\n      this.rawTagName = newname.toLowerCase();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"localName\", {\n    get: function () {\n      return this.rawTagName.toLowerCase();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"isVoidElement\", {\n    get: function () {\n      return this.voidTag.isVoidElement(this.localName);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"rawText\", {\n    /**\n     * Get escpaed (as-it) text value of current node and its children.\n     * @return {string} text content\n     */\n    get: function () {\n      return this.childNodes.reduce(function (pre, cur) {\n        return pre += cur.rawText;\n      }, '');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"textContent\", {\n    get: function () {\n      return decode(this.rawText);\n    },\n    set: function (val) {\n      var content = [new text_1.default(val, this)];\n      this.childNodes = content;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"text\", {\n    /**\n     * Get unescaped text value of current node and its children.\n     * @return {string} text content\n     */\n    get: function () {\n      return decode(this.rawText);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"structuredText\", {\n    /**\n     * Get structured Text (with '\\n' etc.)\n     * @return {string} structured text\n     */\n    get: function () {\n      var currentBlock = [];\n      var blocks = [currentBlock];\n\n      function dfs(node) {\n        if (node.nodeType === type_1.default.ELEMENT_NODE) {\n          if (kBlockElements.has(node.rawTagName)) {\n            if (currentBlock.length > 0) {\n              blocks.push(currentBlock = []);\n            }\n\n            node.childNodes.forEach(dfs);\n\n            if (currentBlock.length > 0) {\n              blocks.push(currentBlock = []);\n            }\n          } else {\n            node.childNodes.forEach(dfs);\n          }\n        } else if (node.nodeType === type_1.default.TEXT_NODE) {\n          if (node.isWhitespace) {\n            // Whitespace node, postponed output\n            currentBlock.prependWhitespace = true;\n          } else {\n            var text = node.trimmedText;\n\n            if (currentBlock.prependWhitespace) {\n              text = \" \".concat(text);\n              currentBlock.prependWhitespace = false;\n            }\n\n            currentBlock.push(text);\n          }\n        }\n      }\n\n      dfs(this);\n      return blocks.map(function (block) {\n        return block.join('').replace(/\\s{2,}/g, ' '); // Normalize each line's whitespace\n      }).join('\\n').replace(/\\s+$/, ''); // trimRight;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  HTMLElement.prototype.toString = function () {\n    var tag = this.rawTagName;\n\n    if (tag) {\n      var attrs = this.rawAttrs ? \" \".concat(this.rawAttrs) : '';\n      return this.voidTag.formatNode(tag, attrs, this.innerHTML);\n    }\n\n    return this.innerHTML;\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"innerHTML\", {\n    get: function () {\n      return this.childNodes.map(function (child) {\n        return child.toString();\n      }).join('');\n    },\n    set: function (content) {\n      var r = parse(content, this._parseOptions);\n      var nodes = r.childNodes.length ? r.childNodes : [new text_1.default(content, this)];\n      resetParent(nodes, this);\n      resetParent(this.childNodes, null);\n      this.childNodes = nodes;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  HTMLElement.prototype.set_content = function (content, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (content instanceof node_1.default) {\n      content = [content];\n    } else if (typeof content == 'string') {\n      options = __assign(__assign({}, this._parseOptions), options);\n      var r = parse(content, options);\n      content = r.childNodes.length ? r.childNodes : [new text_1.default(r.innerHTML, this)];\n    }\n\n    resetParent(this.childNodes, null);\n    resetParent(content, this);\n    this.childNodes = content;\n    return this;\n  };\n\n  HTMLElement.prototype.replaceWith = function () {\n    var _this = this;\n\n    var nodes = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      nodes[_i] = arguments[_i];\n    }\n\n    var parent = this.parentNode;\n    var content = nodes.map(function (node) {\n      if (node instanceof node_1.default) {\n        return [node];\n      } else if (typeof node == 'string') {\n        var r = parse(node, _this._parseOptions);\n        return r.childNodes.length ? r.childNodes : [new text_1.default(node, _this)];\n      }\n\n      return [];\n    }).flat();\n    var idx = parent.childNodes.findIndex(function (child) {\n      return child === _this;\n    });\n    resetParent([this], null);\n    parent.childNodes = __spreadArray(__spreadArray(__spreadArray([], parent.childNodes.slice(0, idx), true), resetParent(content, parent), true), parent.childNodes.slice(idx + 1), true);\n    return this;\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"outerHTML\", {\n    get: function () {\n      return this.toString();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * Trim element from right (in block) after seeing pattern in a TextNode.\n   * @param  {RegExp} pattern pattern to find\n   * @return {HTMLElement}    reference to current node\n   */\n\n  HTMLElement.prototype.trimRight = function (pattern) {\n    for (var i = 0; i < this.childNodes.length; i++) {\n      var childNode = this.childNodes[i];\n\n      if (childNode.nodeType === type_1.default.ELEMENT_NODE) {\n        childNode.trimRight(pattern);\n      } else {\n        var index = childNode.rawText.search(pattern);\n\n        if (index > -1) {\n          childNode.rawText = childNode.rawText.substr(0, index); // trim all following nodes.\n\n          this.childNodes.length = i + 1;\n        }\n      }\n    }\n\n    return this;\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"structure\", {\n    /**\n     * Get DOM structure\n     * @return {string} strucutre\n     */\n    get: function () {\n      var res = [];\n      var indention = 0;\n\n      function write(str) {\n        res.push('  '.repeat(indention) + str);\n      }\n\n      function dfs(node) {\n        var idStr = node.id ? \"#\".concat(node.id) : '';\n        var classStr = node.classList.length ? \".\".concat(node.classList.value.join('.')) : ''; // eslint-disable-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/restrict-template-expressions, @typescript-eslint/no-unsafe-call\n\n        write(\"\".concat(node.rawTagName).concat(idStr).concat(classStr));\n        indention++;\n        node.childNodes.forEach(function (childNode) {\n          if (childNode.nodeType === type_1.default.ELEMENT_NODE) {\n            dfs(childNode);\n          } else if (childNode.nodeType === type_1.default.TEXT_NODE) {\n            if (!childNode.isWhitespace) {\n              write('#text');\n            }\n          }\n        });\n        indention--;\n      }\n\n      dfs(this);\n      return res.join('\\n');\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * Remove whitespaces in this sub tree.\n   * @return {HTMLElement} pointer to this\n   */\n\n  HTMLElement.prototype.removeWhitespace = function () {\n    var _this = this;\n\n    var o = 0;\n    this.childNodes.forEach(function (node) {\n      if (node.nodeType === type_1.default.TEXT_NODE) {\n        if (node.isWhitespace) {\n          return;\n        }\n\n        node.rawText = node.trimmedRawText;\n      } else if (node.nodeType === type_1.default.ELEMENT_NODE) {\n        node.removeWhitespace();\n      }\n\n      _this.childNodes[o++] = node;\n    });\n    this.childNodes.length = o;\n    return this;\n  };\n  /**\n   * Query CSS selector to find matching nodes.\n   * @param  {string}         selector Simplified CSS selector\n   * @return {HTMLElement[]}  matching elements\n   */\n\n\n  HTMLElement.prototype.querySelectorAll = function (selector) {\n    return (0, css_select_1.selectAll)(selector, this, {\n      xmlMode: true,\n      adapter: matcher_1.default\n    });\n  };\n  /**\n   * Query CSS Selector to find matching node.\n   * @param  {string}         selector Simplified CSS selector\n   * @return {(HTMLElement|null)}    matching node\n   */\n\n\n  HTMLElement.prototype.querySelector = function (selector) {\n    return (0, css_select_1.selectOne)(selector, this, {\n      xmlMode: true,\n      adapter: matcher_1.default\n    });\n  };\n  /**\n   * find elements by their tagName\n   * @param {string} tagName the tagName of the elements to select\n   */\n\n\n  HTMLElement.prototype.getElementsByTagName = function (tagName) {\n    var upperCasedTagName = tagName.toUpperCase();\n    var re = [];\n    var stack = [];\n    var currentNodeReference = this;\n    var index = 0; // index turns to undefined once the stack is empty and the first condition occurs\n    // which happens once all relevant children are searched through\n\n    while (index !== undefined) {\n      var child = void 0; // make it work with sparse arrays\n\n      do {\n        child = currentNodeReference.childNodes[index++];\n      } while (index < currentNodeReference.childNodes.length && child === undefined); // if the child does not exist we move on with the last provided index (which belongs to the parentNode)\n\n\n      if (child === undefined) {\n        currentNodeReference = currentNodeReference.parentNode;\n        index = stack.pop();\n        continue;\n      }\n\n      if (child.nodeType === type_1.default.ELEMENT_NODE) {\n        // https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByTagName#syntax\n        if (tagName === '*' || child.tagName === upperCasedTagName) re.push(child); // if children are existing push the current status to the stack and keep searching for elements in the level below\n\n        if (child.childNodes.length > 0) {\n          stack.push(index);\n          currentNodeReference = child;\n          index = 0;\n        }\n      }\n    }\n\n    return re;\n  };\n  /**\n   * find element by it's id\n   * @param {string} id the id of the element to select\n   */\n\n\n  HTMLElement.prototype.getElementById = function (id) {\n    var stack = [];\n    var currentNodeReference = this;\n    var index = 0; // index turns to undefined once the stack is empty and the first condition occurs\n    // which happens once all relevant children are searched through\n\n    while (index !== undefined) {\n      var child = void 0; // make it work with sparse arrays\n\n      do {\n        child = currentNodeReference.childNodes[index++];\n      } while (index < currentNodeReference.childNodes.length && child === undefined); // if the child does not exist we move on with the last provided index (which belongs to the parentNode)\n\n\n      if (child === undefined) {\n        currentNodeReference = currentNodeReference.parentNode;\n        index = stack.pop();\n        continue;\n      }\n\n      if (child.nodeType === type_1.default.ELEMENT_NODE) {\n        if (child.id === id) {\n          return child;\n        }\n\n        ; // if children are existing push the current status to the stack and keep searching for elements in the level below\n\n        if (child.childNodes.length > 0) {\n          stack.push(index);\n          currentNodeReference = child;\n          index = 0;\n        }\n      }\n    }\n\n    return null;\n  };\n  /**\n   * traverses the Element and its parents (heading toward the document root) until it finds a node that matches the provided selector string. Will return itself or the matching ancestor. If no such element exists, it returns null.\n   * @param selector a DOMString containing a selector list\n   */\n\n\n  HTMLElement.prototype.closest = function (selector) {\n    var mapChild = new Map();\n    var el = this;\n    var old = null;\n\n    function findOne(test, elems) {\n      var elem = null;\n\n      for (var i = 0, l = elems.length; i < l && !elem; i++) {\n        var el_1 = elems[i];\n\n        if (test(el_1)) {\n          elem = el_1;\n        } else {\n          var child = mapChild.get(el_1);\n\n          if (child) {\n            elem = findOne(test, [child]);\n          }\n        }\n      }\n\n      return elem;\n    }\n\n    while (el) {\n      mapChild.set(el, old);\n      old = el;\n      el = el.parentNode;\n    }\n\n    el = this;\n\n    while (el) {\n      var e = (0, css_select_1.selectOne)(selector, el, {\n        xmlMode: true,\n        adapter: __assign(__assign({}, matcher_1.default), {\n          getChildren: function (node) {\n            var child = mapChild.get(node);\n            return child && [child];\n          },\n          getSiblings: function (node) {\n            return [node];\n          },\n          findOne: findOne,\n          findAll: function () {\n            return [];\n          }\n        })\n      });\n\n      if (e) {\n        return e;\n      }\n\n      el = el.parentNode;\n    }\n\n    return null;\n  };\n  /**\n   * Append a child node to childNodes\n   * @param  {Node} node node to append\n   * @return {Node}      node appended\n   */\n\n\n  HTMLElement.prototype.appendChild = function (node) {\n    // remove the node from it's parent\n    node.remove();\n    this.childNodes.push(node);\n    node.parentNode = this;\n    return node;\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"firstChild\", {\n    /**\n     * Get first child node\n     * @return {Node} first child node\n     */\n    get: function () {\n      return this.childNodes[0];\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"lastChild\", {\n    /**\n     * Get last child node\n     * @return {Node} last child node\n     */\n    get: function () {\n      return (0, back_1.default)(this.childNodes);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"attrs\", {\n    /**\n     * Get attributes\n     * @access private\n     * @return {Object} parsed and unescaped attributes\n     */\n    get: function () {\n      if (this._attrs) {\n        return this._attrs;\n      }\n\n      this._attrs = {};\n      var attrs = this.rawAttributes;\n\n      for (var key in attrs) {\n        var val = attrs[key] || '';\n        this._attrs[key.toLowerCase()] = decode(val);\n      }\n\n      return this._attrs;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"attributes\", {\n    get: function () {\n      var ret_attrs = {};\n      var attrs = this.rawAttributes;\n\n      for (var key in attrs) {\n        var val = attrs[key] || '';\n        ret_attrs[key] = decode(val);\n      }\n\n      return ret_attrs;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"rawAttributes\", {\n    /**\n     * Get escaped (as-is) attributes\n     * @return {Object} parsed attributes\n     */\n    get: function () {\n      if (this._rawAttrs) {\n        return this._rawAttrs;\n      }\n\n      var attrs = {};\n\n      if (this.rawAttrs) {\n        var re = /([a-zA-Z()[\\]#@$.?][a-zA-Z0-9-_:()[\\]#]*)(?:\\s*=\\s*((?:'[^']*')|(?:\"[^\"]*\")|\\S+))?/g;\n        var match = void 0;\n\n        while (match = re.exec(this.rawAttrs)) {\n          var key = match[1];\n          var val = match[2] || null;\n          if (val && (val[0] === \"'\" || val[0] === \"\\\"\")) val = val.slice(1, val.length - 1);\n          attrs[key] = val;\n        }\n      }\n\n      this._rawAttrs = attrs;\n      return attrs;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  HTMLElement.prototype.removeAttribute = function (key) {\n    var attrs = this.rawAttributes;\n    delete attrs[key]; // Update this.attribute\n\n    if (this._attrs) {\n      delete this._attrs[key];\n    } // Update rawString\n\n\n    this.rawAttrs = Object.keys(attrs).map(function (name) {\n      var val = JSON.stringify(attrs[name]);\n\n      if (val === undefined || val === 'null') {\n        return name;\n      }\n\n      return \"\".concat(name, \"=\").concat(val);\n    }).join(' '); // Update this.id\n\n    if (key === 'id') {\n      this.id = '';\n    }\n\n    return this;\n  };\n\n  HTMLElement.prototype.hasAttribute = function (key) {\n    return key.toLowerCase() in this.attrs;\n  };\n  /**\n   * Get an attribute\n   * @return {string} value of the attribute\n   */\n\n\n  HTMLElement.prototype.getAttribute = function (key) {\n    return this.attrs[key.toLowerCase()];\n  };\n  /**\n   * Set an attribute value to the HTMLElement\n   * @param {string} key The attribute name\n   * @param {string} value The value to set, or null / undefined to remove an attribute\n   */\n\n\n  HTMLElement.prototype.setAttribute = function (key, value) {\n    var _this = this;\n\n    if (arguments.length < 2) {\n      throw new Error(\"Failed to execute 'setAttribute' on 'Element'\");\n    }\n\n    var k2 = key.toLowerCase();\n    var attrs = this.rawAttributes;\n\n    for (var k in attrs) {\n      if (k.toLowerCase() === k2) {\n        key = k;\n        break;\n      }\n    }\n\n    attrs[key] = String(value); // update this.attrs\n\n    if (this._attrs) {\n      this._attrs[k2] = decode(attrs[key]);\n    } // Update rawString\n\n\n    this.rawAttrs = Object.keys(attrs).map(function (name) {\n      var val = _this.quoteAttribute(attrs[name]);\n\n      if (val === 'null' || val === '\"\"') return name;\n      return \"\".concat(name, \"=\").concat(val);\n    }).join(' '); // Update this.id\n\n    if (key === 'id') {\n      this.id = value;\n    }\n\n    return this;\n  };\n  /**\n   * Replace all the attributes of the HTMLElement by the provided attributes\n   * @param {Attributes} attributes the new attribute set\n   */\n\n\n  HTMLElement.prototype.setAttributes = function (attributes) {\n    var _this = this; // Invalidate current this.attributes\n\n\n    if (this._attrs) {\n      delete this._attrs;\n    } // Invalidate current this.rawAttributes\n\n\n    if (this._rawAttrs) {\n      delete this._rawAttrs;\n    } // Update rawString\n\n\n    this.rawAttrs = Object.keys(attributes).map(function (name) {\n      var val = attributes[name];\n      if (val === 'null' || val === '\"\"') return name;\n      return \"\".concat(name, \"=\").concat(_this.quoteAttribute(String(val)));\n    }).join(' ');\n    return this;\n  };\n\n  HTMLElement.prototype.insertAdjacentHTML = function (where, html) {\n    var _a, _b, _c;\n\n    var _this = this;\n\n    if (arguments.length < 2) {\n      throw new Error('2 arguments required');\n    }\n\n    var p = parse(html, this._parseOptions);\n\n    if (where === 'afterend') {\n      var idx = this.parentNode.childNodes.findIndex(function (child) {\n        return child === _this;\n      });\n      resetParent(p.childNodes, this.parentNode);\n\n      (_a = this.parentNode.childNodes).splice.apply(_a, __spreadArray([idx + 1, 0], p.childNodes, false));\n    } else if (where === 'afterbegin') {\n      resetParent(p.childNodes, this);\n\n      (_b = this.childNodes).unshift.apply(_b, p.childNodes);\n    } else if (where === 'beforeend') {\n      p.childNodes.forEach(function (n) {\n        _this.appendChild(n);\n      });\n    } else if (where === 'beforebegin') {\n      var idx = this.parentNode.childNodes.findIndex(function (child) {\n        return child === _this;\n      });\n      resetParent(p.childNodes, this.parentNode);\n\n      (_c = this.parentNode.childNodes).splice.apply(_c, __spreadArray([idx, 0], p.childNodes, false));\n    } else {\n      throw new Error(\"The value provided ('\".concat(where, \"') is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'\"));\n    }\n\n    return this; // if (!where || html === undefined || html === null) {\n    // \treturn;\n    // }\n  };\n\n  Object.defineProperty(HTMLElement.prototype, \"nextSibling\", {\n    get: function () {\n      if (this.parentNode) {\n        var children = this.parentNode.childNodes;\n        var i = 0;\n\n        while (i < children.length) {\n          var child = children[i++];\n          if (this === child) return children[i] || null;\n        }\n\n        return null;\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"nextElementSibling\", {\n    get: function () {\n      if (this.parentNode) {\n        var children = this.parentNode.childNodes;\n        var i = 0;\n        var find = false;\n\n        while (i < children.length) {\n          var child = children[i++];\n\n          if (find) {\n            if (child instanceof HTMLElement) {\n              return child || null;\n            }\n          } else if (this === child) {\n            find = true;\n          }\n        }\n\n        return null;\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"previousSibling\", {\n    get: function () {\n      if (this.parentNode) {\n        var children = this.parentNode.childNodes;\n        var i = children.length;\n\n        while (i > 0) {\n          var child = children[--i];\n          if (this === child) return children[i - 1] || null;\n        }\n\n        return null;\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"previousElementSibling\", {\n    get: function () {\n      if (this.parentNode) {\n        var children = this.parentNode.childNodes;\n        var i = children.length;\n        var find = false;\n\n        while (i > 0) {\n          var child = children[--i];\n\n          if (find) {\n            if (child instanceof HTMLElement) {\n              return child || null;\n            }\n          } else if (this === child) {\n            find = true;\n          }\n        }\n\n        return null;\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(HTMLElement.prototype, \"classNames\", {\n    get: function () {\n      return this.classList.toString();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * Clone this Node\n   */\n\n  HTMLElement.prototype.clone = function () {\n    return parse(this.toString(), this._parseOptions).firstChild;\n  };\n\n  return HTMLElement;\n}(node_1.default);\n\nexports.default = HTMLElement; // https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n\nvar kMarkupPattern = /<!--[\\s\\S]*?-->|<(\\/?)([a-zA-Z][-.:0-9_a-zA-Z]*)((?:\\s+[^>]*?(?:(?:'[^']*')|(?:\"[^\"]*\"))?)*)\\s*(\\/?)>/g;\nvar kAttributePattern = /(?:^|\\s)(id|class)\\s*=\\s*((?:'[^']*')|(?:\"[^\"]*\")|\\S+)/gi;\nvar kSelfClosingElements = {\n  area: true,\n  AREA: true,\n  base: true,\n  BASE: true,\n  br: true,\n  BR: true,\n  col: true,\n  COL: true,\n  hr: true,\n  HR: true,\n  img: true,\n  IMG: true,\n  input: true,\n  INPUT: true,\n  link: true,\n  LINK: true,\n  meta: true,\n  META: true,\n  source: true,\n  SOURCE: true,\n  embed: true,\n  EMBED: true,\n  param: true,\n  PARAM: true,\n  track: true,\n  TRACK: true,\n  wbr: true,\n  WBR: true\n};\nvar kElementsClosedByOpening = {\n  li: {\n    li: true,\n    LI: true\n  },\n  LI: {\n    li: true,\n    LI: true\n  },\n  p: {\n    p: true,\n    div: true,\n    P: true,\n    DIV: true\n  },\n  P: {\n    p: true,\n    div: true,\n    P: true,\n    DIV: true\n  },\n  b: {\n    div: true,\n    DIV: true\n  },\n  B: {\n    div: true,\n    DIV: true\n  },\n  td: {\n    td: true,\n    th: true,\n    TD: true,\n    TH: true\n  },\n  TD: {\n    td: true,\n    th: true,\n    TD: true,\n    TH: true\n  },\n  th: {\n    td: true,\n    th: true,\n    TD: true,\n    TH: true\n  },\n  TH: {\n    td: true,\n    th: true,\n    TD: true,\n    TH: true\n  },\n  h1: {\n    h1: true,\n    H1: true\n  },\n  H1: {\n    h1: true,\n    H1: true\n  },\n  h2: {\n    h2: true,\n    H2: true\n  },\n  H2: {\n    h2: true,\n    H2: true\n  },\n  h3: {\n    h3: true,\n    H3: true\n  },\n  H3: {\n    h3: true,\n    H3: true\n  },\n  h4: {\n    h4: true,\n    H4: true\n  },\n  H4: {\n    h4: true,\n    H4: true\n  },\n  h5: {\n    h5: true,\n    H5: true\n  },\n  H5: {\n    h5: true,\n    H5: true\n  },\n  h6: {\n    h6: true,\n    H6: true\n  },\n  H6: {\n    h6: true,\n    H6: true\n  }\n};\nvar kElementsClosedByClosing = {\n  li: {\n    ul: true,\n    ol: true,\n    UL: true,\n    OL: true\n  },\n  LI: {\n    ul: true,\n    ol: true,\n    UL: true,\n    OL: true\n  },\n  a: {\n    div: true,\n    DIV: true\n  },\n  A: {\n    div: true,\n    DIV: true\n  },\n  b: {\n    div: true,\n    DIV: true\n  },\n  B: {\n    div: true,\n    DIV: true\n  },\n  i: {\n    div: true,\n    DIV: true\n  },\n  I: {\n    div: true,\n    DIV: true\n  },\n  p: {\n    div: true,\n    DIV: true\n  },\n  P: {\n    div: true,\n    DIV: true\n  },\n  td: {\n    tr: true,\n    table: true,\n    TR: true,\n    TABLE: true\n  },\n  TD: {\n    tr: true,\n    table: true,\n    TR: true,\n    TABLE: true\n  },\n  th: {\n    tr: true,\n    table: true,\n    TR: true,\n    TABLE: true\n  },\n  TH: {\n    tr: true,\n    table: true,\n    TR: true,\n    TABLE: true\n  }\n};\nvar frameflag = 'documentfragmentcontainer';\n/**\n * Parses HTML and returns a root element\n * Parse a chuck of HTML source.\n * @param  {string} data      html\n * @return {HTMLElement}      root element\n */\n\nfunction base_parse(data, options) {\n  var _a, _b;\n\n  if (options === void 0) {\n    options = {};\n  }\n\n  var voidTag = new void_tag_1.default((_a = options === null || options === void 0 ? void 0 : options.voidTag) === null || _a === void 0 ? void 0 : _a.closingSlash, (_b = options === null || options === void 0 ? void 0 : options.voidTag) === null || _b === void 0 ? void 0 : _b.tags);\n  var elements = options.blockTextElements || {\n    script: true,\n    noscript: true,\n    style: true,\n    pre: true\n  };\n  var element_names = Object.keys(elements);\n  var kBlockTextElements = element_names.map(function (it) {\n    return new RegExp(\"^\".concat(it, \"$\"), 'i');\n  });\n  var kIgnoreElements = element_names.filter(function (it) {\n    return elements[it];\n  }).map(function (it) {\n    return new RegExp(\"^\".concat(it, \"$\"), 'i');\n  });\n\n  function element_should_be_ignore(tag) {\n    return kIgnoreElements.some(function (it) {\n      return it.test(tag);\n    });\n  }\n\n  function is_block_text_element(tag) {\n    return kBlockTextElements.some(function (it) {\n      return it.test(tag);\n    });\n  }\n\n  var createRange = function (startPos, endPos) {\n    return [startPos - frameFlagOffset, endPos - frameFlagOffset];\n  };\n\n  var root = new HTMLElement(null, {}, '', null, [0, data.length], voidTag, options);\n  var currentParent = root;\n  var stack = [root];\n  var lastTextPos = -1;\n  var noNestedTagIndex = undefined;\n  var match; // https://github.com/taoqf/node-html-parser/issues/38\n\n  data = \"<\".concat(frameflag, \">\").concat(data, \"</\").concat(frameflag, \">\");\n  var lowerCaseTagName = options.lowerCaseTagName,\n      fixNestedATags = options.fixNestedATags;\n  var dataEndPos = data.length - (frameflag.length + 2);\n  var frameFlagOffset = frameflag.length + 2;\n\n  while (match = kMarkupPattern.exec(data)) {\n    // Note: Object destructuring here consistently tests as higher performance than array destructuring\n    // eslint-disable-next-line prefer-const\n    var matchText = match[0],\n        leadingSlash = match[1],\n        tagName = match[2],\n        attributes = match[3],\n        closingSlash = match[4];\n    var matchLength = matchText.length;\n    var tagStartPos = kMarkupPattern.lastIndex - matchLength;\n    var tagEndPos = kMarkupPattern.lastIndex; // Add TextNode if content\n\n    if (lastTextPos > -1) {\n      if (lastTextPos + matchLength < tagEndPos) {\n        var text = data.substring(lastTextPos, tagStartPos);\n        currentParent.appendChild(new text_1.default(text, currentParent, createRange(lastTextPos, tagStartPos)));\n      }\n    }\n\n    lastTextPos = kMarkupPattern.lastIndex; // https://github.com/taoqf/node-html-parser/issues/38\n    // Skip frameflag node\n\n    if (tagName === frameflag) continue; // Handle comments\n\n    if (matchText[1] === '!') {\n      if (options.comment) {\n        // Only keep what is in between <!-- and -->\n        var text = data.substring(tagStartPos + 4, tagEndPos - 3);\n        currentParent.appendChild(new comment_1.default(text, currentParent, createRange(tagStartPos, tagEndPos)));\n      }\n\n      continue;\n    }\n    /* -- Handle tag matching -- */\n    // Fix tag casing if necessary\n\n\n    if (lowerCaseTagName) tagName = tagName.toLowerCase(); // Handle opening tags (ie. <this> not </that>)\n\n    if (!leadingSlash) {\n      /* Populate attributes */\n      var attrs = {};\n\n      for (var attMatch = void 0; attMatch = kAttributePattern.exec(attributes);) {\n        var key = attMatch[1],\n            val = attMatch[2];\n        var isQuoted = val[0] === \"'\" || val[0] === \"\\\"\";\n        attrs[key.toLowerCase()] = isQuoted ? val.slice(1, val.length - 1) : val;\n      }\n\n      var parentTagName = currentParent.rawTagName;\n\n      if (!closingSlash && kElementsClosedByOpening[parentTagName]) {\n        if (kElementsClosedByOpening[parentTagName][tagName]) {\n          stack.pop();\n          currentParent = (0, back_1.default)(stack);\n        }\n      } // Prevent nested A tags by terminating the last A and starting a new one : see issue #144\n\n\n      if (fixNestedATags && (tagName === 'a' || tagName === 'A')) {\n        if (noNestedTagIndex !== undefined) {\n          stack.splice(noNestedTagIndex);\n          currentParent = (0, back_1.default)(stack);\n        }\n\n        noNestedTagIndex = stack.length;\n      }\n\n      var tagEndPos_1 = kMarkupPattern.lastIndex;\n      var tagStartPos_1 = tagEndPos_1 - matchLength;\n      currentParent = currentParent.appendChild( // Initialize range (end position updated later for closed tags)\n      new HTMLElement(tagName, attrs, attributes.slice(1), null, createRange(tagStartPos_1, tagEndPos_1), voidTag, options));\n      stack.push(currentParent);\n\n      if (is_block_text_element(tagName)) {\n        // Find closing tag\n        var closeMarkup = \"</\".concat(tagName, \">\");\n        var closeIndex = lowerCaseTagName ? data.toLocaleLowerCase().indexOf(closeMarkup, kMarkupPattern.lastIndex) : data.indexOf(closeMarkup, kMarkupPattern.lastIndex);\n        var textEndPos = closeIndex === -1 ? dataEndPos : closeIndex;\n\n        if (element_should_be_ignore(tagName)) {\n          var text = data.substring(tagEndPos_1, textEndPos);\n\n          if (text.length > 0 && /\\S/.test(text)) {\n            currentParent.appendChild(new text_1.default(text, currentParent, createRange(tagEndPos_1, textEndPos)));\n          }\n        }\n\n        if (closeIndex === -1) {\n          lastTextPos = kMarkupPattern.lastIndex = data.length + 1;\n        } else {\n          lastTextPos = kMarkupPattern.lastIndex = closeIndex + closeMarkup.length; // Cause to be treated as self-closing, because no close found\n\n          leadingSlash = '/';\n        }\n      }\n    } // Handle closing tags or self-closed elements (ie </tag> or <br>)\n\n\n    if (leadingSlash || closingSlash || kSelfClosingElements[tagName]) {\n      while (true) {\n        if (noNestedTagIndex != null && (tagName === 'a' || tagName === 'A')) noNestedTagIndex = undefined;\n\n        if (currentParent.rawTagName === tagName) {\n          // Update range end for closed tag\n          currentParent.range[1] = createRange(-1, Math.max(lastTextPos, tagEndPos))[1];\n          stack.pop();\n          currentParent = (0, back_1.default)(stack);\n          break;\n        } else {\n          var parentTagName = currentParent.tagName; // Trying to close current tag, and move on\n\n          if (kElementsClosedByClosing[parentTagName]) {\n            if (kElementsClosedByClosing[parentTagName][tagName]) {\n              stack.pop();\n              currentParent = (0, back_1.default)(stack);\n              continue;\n            }\n          } // Use aggressive strategy to handle unmatching markups.\n\n\n          break;\n        }\n      }\n    }\n  }\n\n  return stack;\n}\n\nexports.base_parse = base_parse;\n/**\n * Parses HTML and returns a root element\n * Parse a chuck of HTML source.\n */\n\nfunction parse(data, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var stack = base_parse(data, options);\n  var root = stack[0];\n\n  var _loop_1 = function () {\n    // Handle each error elements.\n    var last = stack.pop();\n    var oneBefore = (0, back_1.default)(stack);\n\n    if (last.parentNode && last.parentNode.parentNode) {\n      if (last.parentNode === oneBefore && last.tagName === oneBefore.tagName) {\n        // Pair error case <h3> <h3> handle : Fixes to <h3> </h3>\n        // this is wrong, becouse this will put the H3 outside the current right position which should be inside the current Html Element, see issue 152 for more info\n        if (options.parseNoneClosedTags !== true) {\n          oneBefore.removeChild(last);\n          last.childNodes.forEach(function (child) {\n            oneBefore.parentNode.appendChild(child);\n          });\n          stack.pop();\n        }\n      } else {\n        // Single error  <div> <h3> </div> handle: Just removes <h3>\n        // Why remove? this is already a HtmlElement and the missing <H3> is already added in this case. see issue 152 for more info\n        // eslint-disable-next-line no-lonely-if\n        if (options.parseNoneClosedTags !== true) {\n          oneBefore.removeChild(last);\n          last.childNodes.forEach(function (child) {\n            oneBefore.appendChild(child);\n          });\n        }\n      }\n    } else {// If it's final element just skip.\n    }\n  };\n\n  while (stack.length > 1) {\n    _loop_1();\n  } // response.childNodes.forEach((node) => {\n  // \tif (node instanceof HTMLElement) {\n  // \t\tnode.parentNode = null;\n  // \t}\n  // });\n\n\n  return root;\n}\n\nexports.parse = parse;\n\nfunction resetParent(nodes, parent) {\n  return nodes.map(function (node) {\n    node.parentNode = parent;\n    return node;\n  });\n}","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","l","ar","slice","concat","__importDefault","mod","__esModule","defineProperty","exports","value","parse","base_parse","css_select_1","require","he_1","back_1","matcher_1","void_tag_1","comment_1","node_1","text_1","type_1","decode","val","JSON","stringify","default","Htags","Dtags","Ftags","tableTags","htmlTags","kBlockElements","Set","addToKBlockElement","args","_i","addToSet","array","index","element","add","toUpperCase","_a","args_1","arg","DOMTokenList","valuesInit","afterUpdate","_set","_afterUpdate","_validate","c","test","Error","replace","c1","c2","delete","remove","toggle","has","contains","get","size","enumerable","configurable","values","toString","join","HTMLElement","_super","tagName","keyAttrs","rawAttrs","parentNode","range","voidTag","_parseOptions","_this","nodeType","ELEMENT_NODE","rawTagName","id","childNodes","classList","class","split","setAttribute","cls","quoteAttribute","attr","removeChild","node","filter","child","exchangeChild","oldNode","newNode","children","map","set","newname","toLowerCase","isVoidElement","localName","reduce","pre","cur","rawText","content","currentBlock","blocks","dfs","push","forEach","TEXT_NODE","isWhitespace","prependWhitespace","text","trimmedText","block","tag","attrs","formatNode","innerHTML","r","nodes","resetParent","set_content","options","replaceWith","parent","flat","idx","findIndex","trimRight","pattern","childNode","search","substr","res","indention","write","str","repeat","idStr","classStr","removeWhitespace","o","trimmedRawText","querySelectorAll","selector","selectAll","xmlMode","adapter","querySelector","selectOne","getElementsByTagName","upperCasedTagName","re","stack","currentNodeReference","undefined","pop","getElementById","closest","mapChild","Map","el","old","findOne","elems","elem","el_1","e","getChildren","getSiblings","findAll","appendChild","_attrs","rawAttributes","key","ret_attrs","_rawAttrs","match","exec","removeAttribute","keys","name","hasAttribute","getAttribute","k2","k","setAttributes","attributes","insertAdjacentHTML","where","html","_b","_c","splice","unshift","find","clone","firstChild","kMarkupPattern","kAttributePattern","kSelfClosingElements","area","AREA","base","BASE","br","BR","col","COL","hr","HR","img","IMG","input","INPUT","link","LINK","meta","META","source","SOURCE","embed","EMBED","param","PARAM","track","TRACK","wbr","WBR","kElementsClosedByOpening","li","LI","div","P","DIV","B","td","th","TD","TH","h1","H1","h2","H2","h3","H3","h4","H4","h5","H5","h6","H6","kElementsClosedByClosing","ul","ol","UL","OL","a","A","I","tr","table","TR","TABLE","frameflag","data","closingSlash","tags","elements","blockTextElements","script","noscript","style","element_names","kBlockTextElements","it","RegExp","kIgnoreElements","element_should_be_ignore","some","is_block_text_element","createRange","startPos","endPos","frameFlagOffset","root","currentParent","lastTextPos","noNestedTagIndex","lowerCaseTagName","fixNestedATags","dataEndPos","matchText","leadingSlash","matchLength","tagStartPos","lastIndex","tagEndPos","substring","comment","attMatch","isQuoted","parentTagName","tagEndPos_1","tagStartPos_1","closeMarkup","closeIndex","toLocaleLowerCase","indexOf","textEndPos","Math","max","_loop_1","last","oneBefore","parseNoneClosedTags"],"sources":["/home/cliffexpc63/my example/portfolio/node_modules/node-html-parser/dist/nodes/html.js"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parse = exports.base_parse = void 0;\nvar css_select_1 = require(\"css-select\");\nvar he_1 = __importDefault(require(\"he\"));\nvar back_1 = __importDefault(require(\"../back\"));\nvar matcher_1 = __importDefault(require(\"../matcher\"));\nvar void_tag_1 = __importDefault(require(\"../void-tag\"));\nvar comment_1 = __importDefault(require(\"./comment\"));\nvar node_1 = __importDefault(require(\"./node\"));\nvar text_1 = __importDefault(require(\"./text\"));\nvar type_1 = __importDefault(require(\"./type\"));\nfunction decode(val) {\n    // clone string\n    return JSON.parse(JSON.stringify(he_1.default.decode(val)));\n}\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements\nvar Htags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hgroup'];\nvar Dtags = ['details', 'dialog', 'dd', 'div', 'dt'];\nvar Ftags = ['fieldset', 'figcaption', 'figure', 'footer', 'form'];\nvar tableTags = ['table', 'td', 'tr'];\nvar htmlTags = ['address', 'article', 'aside', 'blockquote', 'br', 'hr', 'li', 'main', 'nav', 'ol', 'p', 'pre', 'section', 'ul'];\nvar kBlockElements = new Set();\nfunction addToKBlockElement() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var addToSet = function (array) {\n        for (var index = 0; index < array.length; index++) {\n            var element = array[index];\n            kBlockElements.add(element);\n            kBlockElements.add(element.toUpperCase());\n        }\n    };\n    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n        var arg = args_1[_a];\n        addToSet(arg);\n    }\n}\naddToKBlockElement(Htags, Dtags, Ftags, tableTags, htmlTags);\nvar DOMTokenList = /** @class */ (function () {\n    function DOMTokenList(valuesInit, afterUpdate) {\n        if (valuesInit === void 0) { valuesInit = []; }\n        if (afterUpdate === void 0) { afterUpdate = function () { return null; }; }\n        this._set = new Set(valuesInit);\n        this._afterUpdate = afterUpdate;\n    }\n    DOMTokenList.prototype._validate = function (c) {\n        if (/\\s/.test(c)) {\n            throw new Error(\"DOMException in DOMTokenList.add: The token '\".concat(c, \"' contains HTML space characters, which are not valid in tokens.\"));\n        }\n    };\n    DOMTokenList.prototype.add = function (c) {\n        this._validate(c);\n        this._set.add(c);\n        this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n    };\n    DOMTokenList.prototype.replace = function (c1, c2) {\n        this._validate(c2);\n        this._set.delete(c1);\n        this._set.add(c2);\n        this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n    };\n    DOMTokenList.prototype.remove = function (c) {\n        this._set.delete(c) && this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n    };\n    DOMTokenList.prototype.toggle = function (c) {\n        this._validate(c);\n        if (this._set.has(c))\n            this._set.delete(c);\n        else\n            this._set.add(c);\n        this._afterUpdate(this); // eslint-disable-line @typescript-eslint/no-unsafe-call\n    };\n    DOMTokenList.prototype.contains = function (c) {\n        return this._set.has(c);\n    };\n    Object.defineProperty(DOMTokenList.prototype, \"length\", {\n        get: function () {\n            return this._set.size;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DOMTokenList.prototype.values = function () {\n        return this._set.values();\n    };\n    Object.defineProperty(DOMTokenList.prototype, \"value\", {\n        get: function () {\n            return Array.from(this._set.values());\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DOMTokenList.prototype.toString = function () {\n        return Array.from(this._set.values()).join(' ');\n    };\n    return DOMTokenList;\n}());\n/**\n * HTMLElement, which contains a set of children.\n *\n * Note: this is a minimalist implementation, no complete tree\n *   structure provided (no parentNode, nextSibling,\n *   previousSibling etc).\n * @class HTMLElement\n * @extends {Node}\n */\nvar HTMLElement = /** @class */ (function (_super) {\n    __extends(HTMLElement, _super);\n    /**\n     * Creates an instance of HTMLElement.\n     * @param keyAttrs\tid and class attribute\n     * @param [rawAttrs]\tattributes in string\n     *\n     * @memberof HTMLElement\n     */\n    function HTMLElement(tagName, keyAttrs, rawAttrs, parentNode, range, voidTag, _parseOptions) {\n        if (rawAttrs === void 0) { rawAttrs = ''; }\n        if (voidTag === void 0) { voidTag = new void_tag_1.default(); }\n        if (_parseOptions === void 0) { _parseOptions = {}; }\n        var _this = _super.call(this, parentNode, range) || this;\n        _this.rawAttrs = rawAttrs;\n        _this.voidTag = voidTag;\n        /**\n         * Node Type declaration.\n         */\n        _this.nodeType = type_1.default.ELEMENT_NODE;\n        _this.rawTagName = tagName;\n        _this.rawAttrs = rawAttrs || '';\n        _this.id = keyAttrs.id || '';\n        _this.childNodes = [];\n        _this._parseOptions = _parseOptions;\n        _this.classList = new DOMTokenList(keyAttrs.class ? keyAttrs.class.split(/\\s+/) : [], function (classList) { return _this.setAttribute('class', classList.toString()); } // eslint-disable-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call\n        );\n        if (keyAttrs.id) {\n            if (!rawAttrs) {\n                _this.rawAttrs = \"id=\\\"\".concat(keyAttrs.id, \"\\\"\");\n            }\n        }\n        if (keyAttrs.class) {\n            if (!rawAttrs) {\n                var cls = \"class=\\\"\".concat(_this.classList.toString(), \"\\\"\");\n                if (_this.rawAttrs) {\n                    _this.rawAttrs += \" \".concat(cls);\n                }\n                else {\n                    _this.rawAttrs = cls;\n                }\n            }\n        }\n        return _this;\n    }\n    /**\n     * Quote attribute values\n     * @param attr attribute value\n     * @returns {string} quoted value\n     */\n    HTMLElement.prototype.quoteAttribute = function (attr) {\n        if (attr == null) {\n            return 'null';\n        }\n        return JSON.stringify(attr.replace(/\"/g, '&quot;'));\n    };\n    /**\n     * Remove Child element from childNodes array\n     * @param {HTMLElement} node     node to remove\n     */\n    HTMLElement.prototype.removeChild = function (node) {\n        this.childNodes = this.childNodes.filter(function (child) {\n            return child !== node;\n        });\n        return this;\n    };\n    /**\n     * Exchanges given child with new child\n     * @param {HTMLElement} oldNode     node to exchange\n     * @param {HTMLElement} newNode     new node\n     */\n    HTMLElement.prototype.exchangeChild = function (oldNode, newNode) {\n        var children = this.childNodes;\n        this.childNodes = children.map(function (child) {\n            if (child === oldNode) {\n                return newNode;\n            }\n            return child;\n        });\n        return this;\n    };\n    Object.defineProperty(HTMLElement.prototype, \"tagName\", {\n        get: function () {\n            return this.rawTagName ? this.rawTagName.toUpperCase() : this.rawTagName;\n        },\n        set: function (newname) {\n            this.rawTagName = newname.toLowerCase();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"localName\", {\n        get: function () {\n            return this.rawTagName.toLowerCase();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"isVoidElement\", {\n        get: function () {\n            return this.voidTag.isVoidElement(this.localName);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"rawText\", {\n        /**\n         * Get escpaed (as-it) text value of current node and its children.\n         * @return {string} text content\n         */\n        get: function () {\n            return this.childNodes.reduce(function (pre, cur) {\n                return (pre += cur.rawText);\n            }, '');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"textContent\", {\n        get: function () {\n            return decode(this.rawText);\n        },\n        set: function (val) {\n            var content = [new text_1.default(val, this)];\n            this.childNodes = content;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"text\", {\n        /**\n         * Get unescaped text value of current node and its children.\n         * @return {string} text content\n         */\n        get: function () {\n            return decode(this.rawText);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"structuredText\", {\n        /**\n         * Get structured Text (with '\\n' etc.)\n         * @return {string} structured text\n         */\n        get: function () {\n            var currentBlock = [];\n            var blocks = [currentBlock];\n            function dfs(node) {\n                if (node.nodeType === type_1.default.ELEMENT_NODE) {\n                    if (kBlockElements.has(node.rawTagName)) {\n                        if (currentBlock.length > 0) {\n                            blocks.push((currentBlock = []));\n                        }\n                        node.childNodes.forEach(dfs);\n                        if (currentBlock.length > 0) {\n                            blocks.push((currentBlock = []));\n                        }\n                    }\n                    else {\n                        node.childNodes.forEach(dfs);\n                    }\n                }\n                else if (node.nodeType === type_1.default.TEXT_NODE) {\n                    if (node.isWhitespace) {\n                        // Whitespace node, postponed output\n                        currentBlock.prependWhitespace = true;\n                    }\n                    else {\n                        var text = node.trimmedText;\n                        if (currentBlock.prependWhitespace) {\n                            text = \" \".concat(text);\n                            currentBlock.prependWhitespace = false;\n                        }\n                        currentBlock.push(text);\n                    }\n                }\n            }\n            dfs(this);\n            return blocks\n                .map(function (block) {\n                return block.join('').replace(/\\s{2,}/g, ' '); // Normalize each line's whitespace\n            })\n                .join('\\n')\n                .replace(/\\s+$/, ''); // trimRight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HTMLElement.prototype.toString = function () {\n        var tag = this.rawTagName;\n        if (tag) {\n            var attrs = this.rawAttrs ? \" \".concat(this.rawAttrs) : '';\n            return this.voidTag.formatNode(tag, attrs, this.innerHTML);\n        }\n        return this.innerHTML;\n    };\n    Object.defineProperty(HTMLElement.prototype, \"innerHTML\", {\n        get: function () {\n            return this.childNodes\n                .map(function (child) {\n                return child.toString();\n            })\n                .join('');\n        },\n        set: function (content) {\n            var r = parse(content, this._parseOptions);\n            var nodes = r.childNodes.length ? r.childNodes : [new text_1.default(content, this)];\n            resetParent(nodes, this);\n            resetParent(this.childNodes, null);\n            this.childNodes = nodes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HTMLElement.prototype.set_content = function (content, options) {\n        if (options === void 0) { options = {}; }\n        if (content instanceof node_1.default) {\n            content = [content];\n        }\n        else if (typeof content == 'string') {\n            options = __assign(__assign({}, this._parseOptions), options);\n            var r = parse(content, options);\n            content = r.childNodes.length ? r.childNodes : [new text_1.default(r.innerHTML, this)];\n        }\n        resetParent(this.childNodes, null);\n        resetParent(content, this);\n        this.childNodes = content;\n        return this;\n    };\n    HTMLElement.prototype.replaceWith = function () {\n        var _this = this;\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        var parent = this.parentNode;\n        var content = nodes\n            .map(function (node) {\n            if (node instanceof node_1.default) {\n                return [node];\n            }\n            else if (typeof node == 'string') {\n                var r = parse(node, _this._parseOptions);\n                return r.childNodes.length ? r.childNodes : [new text_1.default(node, _this)];\n            }\n            return [];\n        })\n            .flat();\n        var idx = parent.childNodes.findIndex(function (child) {\n            return child === _this;\n        });\n        resetParent([this], null);\n        parent.childNodes = __spreadArray(__spreadArray(__spreadArray([], parent.childNodes.slice(0, idx), true), resetParent(content, parent), true), parent.childNodes.slice(idx + 1), true);\n        return this;\n    };\n    Object.defineProperty(HTMLElement.prototype, \"outerHTML\", {\n        get: function () {\n            return this.toString();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Trim element from right (in block) after seeing pattern in a TextNode.\n     * @param  {RegExp} pattern pattern to find\n     * @return {HTMLElement}    reference to current node\n     */\n    HTMLElement.prototype.trimRight = function (pattern) {\n        for (var i = 0; i < this.childNodes.length; i++) {\n            var childNode = this.childNodes[i];\n            if (childNode.nodeType === type_1.default.ELEMENT_NODE) {\n                childNode.trimRight(pattern);\n            }\n            else {\n                var index = childNode.rawText.search(pattern);\n                if (index > -1) {\n                    childNode.rawText = childNode.rawText.substr(0, index);\n                    // trim all following nodes.\n                    this.childNodes.length = i + 1;\n                }\n            }\n        }\n        return this;\n    };\n    Object.defineProperty(HTMLElement.prototype, \"structure\", {\n        /**\n         * Get DOM structure\n         * @return {string} strucutre\n         */\n        get: function () {\n            var res = [];\n            var indention = 0;\n            function write(str) {\n                res.push('  '.repeat(indention) + str);\n            }\n            function dfs(node) {\n                var idStr = node.id ? \"#\".concat(node.id) : '';\n                var classStr = node.classList.length ? \".\".concat(node.classList.value.join('.')) : ''; // eslint-disable-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/restrict-template-expressions, @typescript-eslint/no-unsafe-call\n                write(\"\".concat(node.rawTagName).concat(idStr).concat(classStr));\n                indention++;\n                node.childNodes.forEach(function (childNode) {\n                    if (childNode.nodeType === type_1.default.ELEMENT_NODE) {\n                        dfs(childNode);\n                    }\n                    else if (childNode.nodeType === type_1.default.TEXT_NODE) {\n                        if (!childNode.isWhitespace) {\n                            write('#text');\n                        }\n                    }\n                });\n                indention--;\n            }\n            dfs(this);\n            return res.join('\\n');\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Remove whitespaces in this sub tree.\n     * @return {HTMLElement} pointer to this\n     */\n    HTMLElement.prototype.removeWhitespace = function () {\n        var _this = this;\n        var o = 0;\n        this.childNodes.forEach(function (node) {\n            if (node.nodeType === type_1.default.TEXT_NODE) {\n                if (node.isWhitespace) {\n                    return;\n                }\n                node.rawText = node.trimmedRawText;\n            }\n            else if (node.nodeType === type_1.default.ELEMENT_NODE) {\n                node.removeWhitespace();\n            }\n            _this.childNodes[o++] = node;\n        });\n        this.childNodes.length = o;\n        return this;\n    };\n    /**\n     * Query CSS selector to find matching nodes.\n     * @param  {string}         selector Simplified CSS selector\n     * @return {HTMLElement[]}  matching elements\n     */\n    HTMLElement.prototype.querySelectorAll = function (selector) {\n        return (0, css_select_1.selectAll)(selector, this, {\n            xmlMode: true,\n            adapter: matcher_1.default,\n        });\n    };\n    /**\n     * Query CSS Selector to find matching node.\n     * @param  {string}         selector Simplified CSS selector\n     * @return {(HTMLElement|null)}    matching node\n     */\n    HTMLElement.prototype.querySelector = function (selector) {\n        return (0, css_select_1.selectOne)(selector, this, {\n            xmlMode: true,\n            adapter: matcher_1.default,\n        });\n    };\n    /**\n     * find elements by their tagName\n     * @param {string} tagName the tagName of the elements to select\n     */\n    HTMLElement.prototype.getElementsByTagName = function (tagName) {\n        var upperCasedTagName = tagName.toUpperCase();\n        var re = [];\n        var stack = [];\n        var currentNodeReference = this;\n        var index = 0;\n        // index turns to undefined once the stack is empty and the first condition occurs\n        // which happens once all relevant children are searched through\n        while (index !== undefined) {\n            var child = void 0;\n            // make it work with sparse arrays\n            do {\n                child = currentNodeReference.childNodes[index++];\n            } while (index < currentNodeReference.childNodes.length && child === undefined);\n            // if the child does not exist we move on with the last provided index (which belongs to the parentNode)\n            if (child === undefined) {\n                currentNodeReference = currentNodeReference.parentNode;\n                index = stack.pop();\n                continue;\n            }\n            if (child.nodeType === type_1.default.ELEMENT_NODE) {\n                // https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByTagName#syntax\n                if (tagName === '*' || child.tagName === upperCasedTagName)\n                    re.push(child);\n                // if children are existing push the current status to the stack and keep searching for elements in the level below\n                if (child.childNodes.length > 0) {\n                    stack.push(index);\n                    currentNodeReference = child;\n                    index = 0;\n                }\n            }\n        }\n        return re;\n    };\n    /**\n     * find element by it's id\n     * @param {string} id the id of the element to select\n     */\n    HTMLElement.prototype.getElementById = function (id) {\n        var stack = [];\n        var currentNodeReference = this;\n        var index = 0;\n        // index turns to undefined once the stack is empty and the first condition occurs\n        // which happens once all relevant children are searched through\n        while (index !== undefined) {\n            var child = void 0;\n            // make it work with sparse arrays\n            do {\n                child = currentNodeReference.childNodes[index++];\n            } while (index < currentNodeReference.childNodes.length && child === undefined);\n            // if the child does not exist we move on with the last provided index (which belongs to the parentNode)\n            if (child === undefined) {\n                currentNodeReference = currentNodeReference.parentNode;\n                index = stack.pop();\n                continue;\n            }\n            if (child.nodeType === type_1.default.ELEMENT_NODE) {\n                if (child.id === id) {\n                    return child;\n                }\n                ;\n                // if children are existing push the current status to the stack and keep searching for elements in the level below\n                if (child.childNodes.length > 0) {\n                    stack.push(index);\n                    currentNodeReference = child;\n                    index = 0;\n                }\n            }\n        }\n        return null;\n    };\n    /**\n     * traverses the Element and its parents (heading toward the document root) until it finds a node that matches the provided selector string. Will return itself or the matching ancestor. If no such element exists, it returns null.\n     * @param selector a DOMString containing a selector list\n     */\n    HTMLElement.prototype.closest = function (selector) {\n        var mapChild = new Map();\n        var el = this;\n        var old = null;\n        function findOne(test, elems) {\n            var elem = null;\n            for (var i = 0, l = elems.length; i < l && !elem; i++) {\n                var el_1 = elems[i];\n                if (test(el_1)) {\n                    elem = el_1;\n                }\n                else {\n                    var child = mapChild.get(el_1);\n                    if (child) {\n                        elem = findOne(test, [child]);\n                    }\n                }\n            }\n            return elem;\n        }\n        while (el) {\n            mapChild.set(el, old);\n            old = el;\n            el = el.parentNode;\n        }\n        el = this;\n        while (el) {\n            var e = (0, css_select_1.selectOne)(selector, el, {\n                xmlMode: true,\n                adapter: __assign(__assign({}, matcher_1.default), { getChildren: function (node) {\n                        var child = mapChild.get(node);\n                        return child && [child];\n                    }, getSiblings: function (node) {\n                        return [node];\n                    }, findOne: findOne, findAll: function () {\n                        return [];\n                    } }),\n            });\n            if (e) {\n                return e;\n            }\n            el = el.parentNode;\n        }\n        return null;\n    };\n    /**\n     * Append a child node to childNodes\n     * @param  {Node} node node to append\n     * @return {Node}      node appended\n     */\n    HTMLElement.prototype.appendChild = function (node) {\n        // remove the node from it's parent\n        node.remove();\n        this.childNodes.push(node);\n        node.parentNode = this;\n        return node;\n    };\n    Object.defineProperty(HTMLElement.prototype, \"firstChild\", {\n        /**\n         * Get first child node\n         * @return {Node} first child node\n         */\n        get: function () {\n            return this.childNodes[0];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"lastChild\", {\n        /**\n         * Get last child node\n         * @return {Node} last child node\n         */\n        get: function () {\n            return (0, back_1.default)(this.childNodes);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"attrs\", {\n        /**\n         * Get attributes\n         * @access private\n         * @return {Object} parsed and unescaped attributes\n         */\n        get: function () {\n            if (this._attrs) {\n                return this._attrs;\n            }\n            this._attrs = {};\n            var attrs = this.rawAttributes;\n            for (var key in attrs) {\n                var val = attrs[key] || '';\n                this._attrs[key.toLowerCase()] = decode(val);\n            }\n            return this._attrs;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"attributes\", {\n        get: function () {\n            var ret_attrs = {};\n            var attrs = this.rawAttributes;\n            for (var key in attrs) {\n                var val = attrs[key] || '';\n                ret_attrs[key] = decode(val);\n            }\n            return ret_attrs;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"rawAttributes\", {\n        /**\n         * Get escaped (as-is) attributes\n         * @return {Object} parsed attributes\n         */\n        get: function () {\n            if (this._rawAttrs) {\n                return this._rawAttrs;\n            }\n            var attrs = {};\n            if (this.rawAttrs) {\n                var re = /([a-zA-Z()[\\]#@$.?][a-zA-Z0-9-_:()[\\]#]*)(?:\\s*=\\s*((?:'[^']*')|(?:\"[^\"]*\")|\\S+))?/g;\n                var match = void 0;\n                while ((match = re.exec(this.rawAttrs))) {\n                    var key = match[1];\n                    var val = match[2] || null;\n                    if (val && (val[0] === \"'\" || val[0] === \"\\\"\"))\n                        val = val.slice(1, val.length - 1);\n                    attrs[key] = val;\n                }\n            }\n            this._rawAttrs = attrs;\n            return attrs;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HTMLElement.prototype.removeAttribute = function (key) {\n        var attrs = this.rawAttributes;\n        delete attrs[key];\n        // Update this.attribute\n        if (this._attrs) {\n            delete this._attrs[key];\n        }\n        // Update rawString\n        this.rawAttrs = Object.keys(attrs)\n            .map(function (name) {\n            var val = JSON.stringify(attrs[name]);\n            if (val === undefined || val === 'null') {\n                return name;\n            }\n            return \"\".concat(name, \"=\").concat(val);\n        })\n            .join(' ');\n        // Update this.id\n        if (key === 'id') {\n            this.id = '';\n        }\n        return this;\n    };\n    HTMLElement.prototype.hasAttribute = function (key) {\n        return key.toLowerCase() in this.attrs;\n    };\n    /**\n     * Get an attribute\n     * @return {string} value of the attribute\n     */\n    HTMLElement.prototype.getAttribute = function (key) {\n        return this.attrs[key.toLowerCase()];\n    };\n    /**\n     * Set an attribute value to the HTMLElement\n     * @param {string} key The attribute name\n     * @param {string} value The value to set, or null / undefined to remove an attribute\n     */\n    HTMLElement.prototype.setAttribute = function (key, value) {\n        var _this = this;\n        if (arguments.length < 2) {\n            throw new Error(\"Failed to execute 'setAttribute' on 'Element'\");\n        }\n        var k2 = key.toLowerCase();\n        var attrs = this.rawAttributes;\n        for (var k in attrs) {\n            if (k.toLowerCase() === k2) {\n                key = k;\n                break;\n            }\n        }\n        attrs[key] = String(value);\n        // update this.attrs\n        if (this._attrs) {\n            this._attrs[k2] = decode(attrs[key]);\n        }\n        // Update rawString\n        this.rawAttrs = Object.keys(attrs)\n            .map(function (name) {\n            var val = _this.quoteAttribute(attrs[name]);\n            if (val === 'null' || val === '\"\"')\n                return name;\n            return \"\".concat(name, \"=\").concat(val);\n        })\n            .join(' ');\n        // Update this.id\n        if (key === 'id') {\n            this.id = value;\n        }\n        return this;\n    };\n    /**\n     * Replace all the attributes of the HTMLElement by the provided attributes\n     * @param {Attributes} attributes the new attribute set\n     */\n    HTMLElement.prototype.setAttributes = function (attributes) {\n        var _this = this;\n        // Invalidate current this.attributes\n        if (this._attrs) {\n            delete this._attrs;\n        }\n        // Invalidate current this.rawAttributes\n        if (this._rawAttrs) {\n            delete this._rawAttrs;\n        }\n        // Update rawString\n        this.rawAttrs = Object.keys(attributes)\n            .map(function (name) {\n            var val = attributes[name];\n            if (val === 'null' || val === '\"\"')\n                return name;\n            return \"\".concat(name, \"=\").concat(_this.quoteAttribute(String(val)));\n        })\n            .join(' ');\n        return this;\n    };\n    HTMLElement.prototype.insertAdjacentHTML = function (where, html) {\n        var _a, _b, _c;\n        var _this = this;\n        if (arguments.length < 2) {\n            throw new Error('2 arguments required');\n        }\n        var p = parse(html, this._parseOptions);\n        if (where === 'afterend') {\n            var idx = this.parentNode.childNodes.findIndex(function (child) {\n                return child === _this;\n            });\n            resetParent(p.childNodes, this.parentNode);\n            (_a = this.parentNode.childNodes).splice.apply(_a, __spreadArray([idx + 1, 0], p.childNodes, false));\n        }\n        else if (where === 'afterbegin') {\n            resetParent(p.childNodes, this);\n            (_b = this.childNodes).unshift.apply(_b, p.childNodes);\n        }\n        else if (where === 'beforeend') {\n            p.childNodes.forEach(function (n) {\n                _this.appendChild(n);\n            });\n        }\n        else if (where === 'beforebegin') {\n            var idx = this.parentNode.childNodes.findIndex(function (child) {\n                return child === _this;\n            });\n            resetParent(p.childNodes, this.parentNode);\n            (_c = this.parentNode.childNodes).splice.apply(_c, __spreadArray([idx, 0], p.childNodes, false));\n        }\n        else {\n            throw new Error(\"The value provided ('\".concat(where, \"') is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'\"));\n        }\n        return this;\n        // if (!where || html === undefined || html === null) {\n        // \treturn;\n        // }\n    };\n    Object.defineProperty(HTMLElement.prototype, \"nextSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var children = this.parentNode.childNodes;\n                var i = 0;\n                while (i < children.length) {\n                    var child = children[i++];\n                    if (this === child)\n                        return children[i] || null;\n                }\n                return null;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"nextElementSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var children = this.parentNode.childNodes;\n                var i = 0;\n                var find = false;\n                while (i < children.length) {\n                    var child = children[i++];\n                    if (find) {\n                        if (child instanceof HTMLElement) {\n                            return child || null;\n                        }\n                    }\n                    else if (this === child) {\n                        find = true;\n                    }\n                }\n                return null;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"previousSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var children = this.parentNode.childNodes;\n                var i = children.length;\n                while (i > 0) {\n                    var child = children[--i];\n                    if (this === child)\n                        return children[i - 1] || null;\n                }\n                return null;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"previousElementSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var children = this.parentNode.childNodes;\n                var i = children.length;\n                var find = false;\n                while (i > 0) {\n                    var child = children[--i];\n                    if (find) {\n                        if (child instanceof HTMLElement) {\n                            return child || null;\n                        }\n                    }\n                    else if (this === child) {\n                        find = true;\n                    }\n                }\n                return null;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HTMLElement.prototype, \"classNames\", {\n        get: function () {\n            return this.classList.toString();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Clone this Node\n     */\n    HTMLElement.prototype.clone = function () {\n        return parse(this.toString(), this._parseOptions).firstChild;\n    };\n    return HTMLElement;\n}(node_1.default));\nexports.default = HTMLElement;\n// https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\nvar kMarkupPattern = /<!--[\\s\\S]*?-->|<(\\/?)([a-zA-Z][-.:0-9_a-zA-Z]*)((?:\\s+[^>]*?(?:(?:'[^']*')|(?:\"[^\"]*\"))?)*)\\s*(\\/?)>/g;\nvar kAttributePattern = /(?:^|\\s)(id|class)\\s*=\\s*((?:'[^']*')|(?:\"[^\"]*\")|\\S+)/gi;\nvar kSelfClosingElements = {\n    area: true,\n    AREA: true,\n    base: true,\n    BASE: true,\n    br: true,\n    BR: true,\n    col: true,\n    COL: true,\n    hr: true,\n    HR: true,\n    img: true,\n    IMG: true,\n    input: true,\n    INPUT: true,\n    link: true,\n    LINK: true,\n    meta: true,\n    META: true,\n    source: true,\n    SOURCE: true,\n    embed: true,\n    EMBED: true,\n    param: true,\n    PARAM: true,\n    track: true,\n    TRACK: true,\n    wbr: true,\n    WBR: true,\n};\nvar kElementsClosedByOpening = {\n    li: { li: true, LI: true },\n    LI: { li: true, LI: true },\n    p: { p: true, div: true, P: true, DIV: true },\n    P: { p: true, div: true, P: true, DIV: true },\n    b: { div: true, DIV: true },\n    B: { div: true, DIV: true },\n    td: { td: true, th: true, TD: true, TH: true },\n    TD: { td: true, th: true, TD: true, TH: true },\n    th: { td: true, th: true, TD: true, TH: true },\n    TH: { td: true, th: true, TD: true, TH: true },\n    h1: { h1: true, H1: true },\n    H1: { h1: true, H1: true },\n    h2: { h2: true, H2: true },\n    H2: { h2: true, H2: true },\n    h3: { h3: true, H3: true },\n    H3: { h3: true, H3: true },\n    h4: { h4: true, H4: true },\n    H4: { h4: true, H4: true },\n    h5: { h5: true, H5: true },\n    H5: { h5: true, H5: true },\n    h6: { h6: true, H6: true },\n    H6: { h6: true, H6: true },\n};\nvar kElementsClosedByClosing = {\n    li: { ul: true, ol: true, UL: true, OL: true },\n    LI: { ul: true, ol: true, UL: true, OL: true },\n    a: { div: true, DIV: true },\n    A: { div: true, DIV: true },\n    b: { div: true, DIV: true },\n    B: { div: true, DIV: true },\n    i: { div: true, DIV: true },\n    I: { div: true, DIV: true },\n    p: { div: true, DIV: true },\n    P: { div: true, DIV: true },\n    td: { tr: true, table: true, TR: true, TABLE: true },\n    TD: { tr: true, table: true, TR: true, TABLE: true },\n    th: { tr: true, table: true, TR: true, TABLE: true },\n    TH: { tr: true, table: true, TR: true, TABLE: true },\n};\nvar frameflag = 'documentfragmentcontainer';\n/**\n * Parses HTML and returns a root element\n * Parse a chuck of HTML source.\n * @param  {string} data      html\n * @return {HTMLElement}      root element\n */\nfunction base_parse(data, options) {\n    var _a, _b;\n    if (options === void 0) { options = {}; }\n    var voidTag = new void_tag_1.default((_a = options === null || options === void 0 ? void 0 : options.voidTag) === null || _a === void 0 ? void 0 : _a.closingSlash, (_b = options === null || options === void 0 ? void 0 : options.voidTag) === null || _b === void 0 ? void 0 : _b.tags);\n    var elements = options.blockTextElements || {\n        script: true,\n        noscript: true,\n        style: true,\n        pre: true,\n    };\n    var element_names = Object.keys(elements);\n    var kBlockTextElements = element_names.map(function (it) { return new RegExp(\"^\".concat(it, \"$\"), 'i'); });\n    var kIgnoreElements = element_names.filter(function (it) { return elements[it]; }).map(function (it) { return new RegExp(\"^\".concat(it, \"$\"), 'i'); });\n    function element_should_be_ignore(tag) {\n        return kIgnoreElements.some(function (it) { return it.test(tag); });\n    }\n    function is_block_text_element(tag) {\n        return kBlockTextElements.some(function (it) { return it.test(tag); });\n    }\n    var createRange = function (startPos, endPos) { return [startPos - frameFlagOffset, endPos - frameFlagOffset]; };\n    var root = new HTMLElement(null, {}, '', null, [0, data.length], voidTag, options);\n    var currentParent = root;\n    var stack = [root];\n    var lastTextPos = -1;\n    var noNestedTagIndex = undefined;\n    var match;\n    // https://github.com/taoqf/node-html-parser/issues/38\n    data = \"<\".concat(frameflag, \">\").concat(data, \"</\").concat(frameflag, \">\");\n    var lowerCaseTagName = options.lowerCaseTagName, fixNestedATags = options.fixNestedATags;\n    var dataEndPos = data.length - (frameflag.length + 2);\n    var frameFlagOffset = frameflag.length + 2;\n    while ((match = kMarkupPattern.exec(data))) {\n        // Note: Object destructuring here consistently tests as higher performance than array destructuring\n        // eslint-disable-next-line prefer-const\n        var matchText = match[0], leadingSlash = match[1], tagName = match[2], attributes = match[3], closingSlash = match[4];\n        var matchLength = matchText.length;\n        var tagStartPos = kMarkupPattern.lastIndex - matchLength;\n        var tagEndPos = kMarkupPattern.lastIndex;\n        // Add TextNode if content\n        if (lastTextPos > -1) {\n            if (lastTextPos + matchLength < tagEndPos) {\n                var text = data.substring(lastTextPos, tagStartPos);\n                currentParent.appendChild(new text_1.default(text, currentParent, createRange(lastTextPos, tagStartPos)));\n            }\n        }\n        lastTextPos = kMarkupPattern.lastIndex;\n        // https://github.com/taoqf/node-html-parser/issues/38\n        // Skip frameflag node\n        if (tagName === frameflag)\n            continue;\n        // Handle comments\n        if (matchText[1] === '!') {\n            if (options.comment) {\n                // Only keep what is in between <!-- and -->\n                var text = data.substring(tagStartPos + 4, tagEndPos - 3);\n                currentParent.appendChild(new comment_1.default(text, currentParent, createRange(tagStartPos, tagEndPos)));\n            }\n            continue;\n        }\n        /* -- Handle tag matching -- */\n        // Fix tag casing if necessary\n        if (lowerCaseTagName)\n            tagName = tagName.toLowerCase();\n        // Handle opening tags (ie. <this> not </that>)\n        if (!leadingSlash) {\n            /* Populate attributes */\n            var attrs = {};\n            for (var attMatch = void 0; (attMatch = kAttributePattern.exec(attributes));) {\n                var key = attMatch[1], val = attMatch[2];\n                var isQuoted = val[0] === \"'\" || val[0] === \"\\\"\";\n                attrs[key.toLowerCase()] = isQuoted ? val.slice(1, val.length - 1) : val;\n            }\n            var parentTagName = currentParent.rawTagName;\n            if (!closingSlash && kElementsClosedByOpening[parentTagName]) {\n                if (kElementsClosedByOpening[parentTagName][tagName]) {\n                    stack.pop();\n                    currentParent = (0, back_1.default)(stack);\n                }\n            }\n            // Prevent nested A tags by terminating the last A and starting a new one : see issue #144\n            if (fixNestedATags && (tagName === 'a' || tagName === 'A')) {\n                if (noNestedTagIndex !== undefined) {\n                    stack.splice(noNestedTagIndex);\n                    currentParent = (0, back_1.default)(stack);\n                }\n                noNestedTagIndex = stack.length;\n            }\n            var tagEndPos_1 = kMarkupPattern.lastIndex;\n            var tagStartPos_1 = tagEndPos_1 - matchLength;\n            currentParent = currentParent.appendChild(\n            // Initialize range (end position updated later for closed tags)\n            new HTMLElement(tagName, attrs, attributes.slice(1), null, createRange(tagStartPos_1, tagEndPos_1), voidTag, options));\n            stack.push(currentParent);\n            if (is_block_text_element(tagName)) {\n                // Find closing tag\n                var closeMarkup = \"</\".concat(tagName, \">\");\n                var closeIndex = lowerCaseTagName\n                    ? data.toLocaleLowerCase().indexOf(closeMarkup, kMarkupPattern.lastIndex)\n                    : data.indexOf(closeMarkup, kMarkupPattern.lastIndex);\n                var textEndPos = closeIndex === -1 ? dataEndPos : closeIndex;\n                if (element_should_be_ignore(tagName)) {\n                    var text = data.substring(tagEndPos_1, textEndPos);\n                    if (text.length > 0 && /\\S/.test(text)) {\n                        currentParent.appendChild(new text_1.default(text, currentParent, createRange(tagEndPos_1, textEndPos)));\n                    }\n                }\n                if (closeIndex === -1) {\n                    lastTextPos = kMarkupPattern.lastIndex = data.length + 1;\n                }\n                else {\n                    lastTextPos = kMarkupPattern.lastIndex = closeIndex + closeMarkup.length;\n                    // Cause to be treated as self-closing, because no close found\n                    leadingSlash = '/';\n                }\n            }\n        }\n        // Handle closing tags or self-closed elements (ie </tag> or <br>)\n        if (leadingSlash || closingSlash || kSelfClosingElements[tagName]) {\n            while (true) {\n                if (noNestedTagIndex != null && (tagName === 'a' || tagName === 'A'))\n                    noNestedTagIndex = undefined;\n                if (currentParent.rawTagName === tagName) {\n                    // Update range end for closed tag\n                    currentParent.range[1] = createRange(-1, Math.max(lastTextPos, tagEndPos))[1];\n                    stack.pop();\n                    currentParent = (0, back_1.default)(stack);\n                    break;\n                }\n                else {\n                    var parentTagName = currentParent.tagName;\n                    // Trying to close current tag, and move on\n                    if (kElementsClosedByClosing[parentTagName]) {\n                        if (kElementsClosedByClosing[parentTagName][tagName]) {\n                            stack.pop();\n                            currentParent = (0, back_1.default)(stack);\n                            continue;\n                        }\n                    }\n                    // Use aggressive strategy to handle unmatching markups.\n                    break;\n                }\n            }\n        }\n    }\n    return stack;\n}\nexports.base_parse = base_parse;\n/**\n * Parses HTML and returns a root element\n * Parse a chuck of HTML source.\n */\nfunction parse(data, options) {\n    if (options === void 0) { options = {}; }\n    var stack = base_parse(data, options);\n    var root = stack[0];\n    var _loop_1 = function () {\n        // Handle each error elements.\n        var last = stack.pop();\n        var oneBefore = (0, back_1.default)(stack);\n        if (last.parentNode && last.parentNode.parentNode) {\n            if (last.parentNode === oneBefore && last.tagName === oneBefore.tagName) {\n                // Pair error case <h3> <h3> handle : Fixes to <h3> </h3>\n                // this is wrong, becouse this will put the H3 outside the current right position which should be inside the current Html Element, see issue 152 for more info\n                if (options.parseNoneClosedTags !== true) {\n                    oneBefore.removeChild(last);\n                    last.childNodes.forEach(function (child) {\n                        oneBefore.parentNode.appendChild(child);\n                    });\n                    stack.pop();\n                }\n            }\n            else {\n                // Single error  <div> <h3> </div> handle: Just removes <h3>\n                // Why remove? this is already a HtmlElement and the missing <H3> is already added in this case. see issue 152 for more info\n                // eslint-disable-next-line no-lonely-if\n                if (options.parseNoneClosedTags !== true) {\n                    oneBefore.removeChild(last);\n                    last.childNodes.forEach(function (child) {\n                        oneBefore.appendChild(child);\n                    });\n                }\n            }\n        }\n        else {\n            // If it's final element just skip.\n        }\n    };\n    while (stack.length > 1) {\n        _loop_1();\n    }\n    // response.childNodes.forEach((node) => {\n    // \tif (node instanceof HTMLElement) {\n    // \t\tnode.parentNode = null;\n    // \t}\n    // });\n    return root;\n}\nexports.parse = parse;\nfunction resetParent(nodes, parent) {\n    return nodes.map(function (node) {\n        node.parentNode = parent;\n        return node;\n    });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}